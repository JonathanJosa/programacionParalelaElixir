<style> pre{background-color: #292F36;} </style><file name='frank.ex'ubicacion='media/shared/partner1/frank.ex'><pre><code> <span style='color:#C19875'> ·</span> <span style='color:#565857;'><i># A micro web DSL library called </i></span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>Frank</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span> <span style='color:#565857;'><i># The motivation was mainly to learn about macros.</i></span>
 <span style='color:#C19875'> ·</span> <span style='color:#565857;'><i># One big bummer is that the way I implemented the macro,</i></span>
 <span style='color:#C19875'> ·</span> <span style='color:#565857;'><i># there is no way to build a route based on a regex,</i></span>
 <span style='color:#C19875'> ·</span> <span style='color:#565857;'><i># which is essential for a web DSL. </i></span><span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> <span style='color:#565857;'><i># Next version will hopefully support regex paths.</i></span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span> <span style='color:#FBFBFF;'>require</span> <span style='color:#FBFBFF;'>Record</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span> <span style='color:#1098F7;'>defmodule</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>Frank</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@moduledoc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>Frank</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>micro</span> <span style='color:#FBFBFF;'>web</span> <span style='color:#FBFBFF;'>library</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>provides</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>DSL</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>defining</span> <span style='color:#FBFBFF;'>routes</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>defmodule</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>MyApp</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>Frank</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>get</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>foo</span><span style='color:#FBFBFF;'>"</span> <span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>             <span style='color:#FBFBFF;'>response</span> <span style='color:#FBFBFF;'>200</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>foo</span><span style='color:#1098F7;'>!</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#D7B884;'>Frank.</span><span style='color:#FBFBFF;'>sing</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>MyApp</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>To</span> <span style='color:#FBFBFF;'>run:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>$</span> <span style='color:#FBFBFF;'>iex</span> <span style='color:#FBFBFF;'>26</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>frank</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>exs</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>then</span> <span style='color:#FBFBFF;'>point</span> <span style='color:#FBFBFF;'>your</span> <span style='color:#FBFBFF;'>browser</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>http:</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>localhost:3000</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#D7B884;'>Record.</span><span style='color:#FBFBFF;'>defrecord</span> <span style='color:#EAC435;'><i>:mod</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#D7B884;'>Record.</span><span style='color:#FBFBFF;'>extract</span><span style='color:#FBFBFF;'>(</span><span style='color:#EAC435;'><i>:mod</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>lib:</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>inets</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>include</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>httpd</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>hrl</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@doc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>Start</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>web</span> <span style='color:#FBFBFF;'>server</span> <span style='color:#FBFBFF;'>given</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>app</span> <span style='color:#FBFBFF;'>module</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>sing</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>module</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#EAC435;'><i>:inets</i></span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>options</span> <span style='color:#1098F7;'>=</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>server</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>name:</span> <span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>frank</span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>server</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>root:</span> <span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>tmp</span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>document</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>root:</span> <span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>tmp</span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>port:</span> <span style='color:#FBFBFF;'>3000</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>modules:</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>module</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>]</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>pid</span><span style='color:#FBFBFF;'>}</span> <span style='color:#1098F7;'>=</span> <span style='color:#EAC435;'><i>:inets</i></span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>start</span> <span style='color:#EAC435;'><i>:httpd</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>options</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#D7B884;'>IO.</span><span style='color:#FBFBFF;'>puts</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>running</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>port</span> <span style='color:#FBFBFF;'>3000</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>defmacro</span> <span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>using</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>opts</span><span style='color:#FBFBFF;'>)</span> <span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>quote</span> <span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>import</span> <span style='color:#D7B884;'>Frank.</span><span style='color:#FBFBFF;'>Path</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>unquote</span><span style='color:#9A8BBB;'>(</span><span style='color:#EAC435;'>:do</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>data</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>name</span> <span style='color:#1098F7;'>=</span> <span style='color:#D7B884;'>List.</span><span style='color:#FBFBFF;'>to</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>atom</span><span style='color:#FBFBFF;'>(</span><span style='color:#D7B884;'>Frank.</span><span style='color:#FBFBFF;'>mod</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>data</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:request</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>uri</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>funs</span> <span style='color:#1098F7;'>=</span> <span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>MODULE</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>info</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>(</span><span style='color:#EAC435;'><i>:functions</i></span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>if</span> <span style='color:#D7B884;'>Keyword.</span><span style='color:#FBFBFF;'>get</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>funs</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>name</span><span style='color:#FBFBFF;'>)</span> <span style='color:#1098F7;'>=</span><span style='color:#1098F7;'>=</span> <span style='color:#FBFBFF;'>1</span> <span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>fun</span> <span style='color:#1098F7;'>=</span> <span style='color:#EAC435;'><i>:erlang</i></span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>make</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>fun</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>MODULE</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>name</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>1</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>fun</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>data</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>else</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>response</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>404</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>not</span> <span style='color:#FBFBFF;'>defined</span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#1098F7;'>defmodule</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>Path</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>defmacro</span> <span style='color:#FBFBFF;'>get</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>path</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>contents</span><span style='color:#FBFBFF;'>)</span> <span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>contents</span> <span style='color:#1098F7;'>=</span> <span style='color:#D7B884;'>Macro.</span><span style='color:#FBFBFF;'>escape</span><span style='color:#FBFBFF;'>(</span><span style='color:#D7B884;'>Keyword.</span><span style='color:#FBFBFF;'>get</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>contents</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:do</i></span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>unquote:</span> <span style='color:#4ECDC4;'><i>true</i></span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>quote</span> <span style='color:#FBFBFF;'>bind</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>quoted:</span> <span style='color:#FBFBFF;'>binding</span> <span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>unquote</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>String.</span><span style='color:#03DDB2;'>to</span><span style='color:#03DDB2;'>_</span><span style='color:#03DDB2;'>atom</span><span style='color:#03DDB2;'>(</span><span style='color:#03DDB2;'>path</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>data</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>unquote</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>contents</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>redirect</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>path</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>code</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>\</span><span style='color:#03DDB2;'>\</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>302</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>body</span> <span style='color:#1098F7;'>=</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>redirecting</span> <span style='color:#FBFBFF;'>you</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#1098F7;'><</span><span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>href</span><span style='color:#1098F7;'>=</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>path</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>"</span><span style='color:#1098F7;'>></span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>path</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>'</span><span style='color:#1098F7;'><</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>a</span><span style='color:#1098F7;'>></span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>]</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>response</span> <span style='color:#FBFBFF;'>code</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>body</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>location:</span> <span style='color:#FBFBFF;'>path</span><span style='color:#FBFBFF;'>]</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>sanitize</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>content</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>content</span> <span style='color:#1098F7;'>=</span> <span style='color:#D7B884;'>Regex.</span><span style='color:#FBFBFF;'>replace</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>~</span><span style='color:#FBFBFF;'>r</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>&</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>content</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>\</span><span style='color:#FBFBFF;'>\</span><span style='color:#FBFBFF;'>&</span><span style='color:#FBFBFF;'>amp</span><span style='color:#FBFBFF;'>;</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>content</span> <span style='color:#1098F7;'>=</span> <span style='color:#D7B884;'>Regex.</span><span style='color:#FBFBFF;'>replace</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>~</span><span style='color:#FBFBFF;'>r</span><span style='color:#FBFBFF;'>/</span><span style='color:#1098F7;'><</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>content</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>\</span><span style='color:#FBFBFF;'>\</span><span style='color:#FBFBFF;'>&</span><span style='color:#FBFBFF;'>lt</span><span style='color:#FBFBFF;'>;</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>content</span> <span style='color:#1098F7;'>=</span> <span style='color:#D7B884;'>Regex.</span><span style='color:#FBFBFF;'>replace</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>~</span><span style='color:#FBFBFF;'>r</span><span style='color:#FBFBFF;'>/</span><span style='color:#1098F7;'>></span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>content</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>\</span><span style='color:#FBFBFF;'>\</span><span style='color:#FBFBFF;'>&</span><span style='color:#FBFBFF;'>gt</span><span style='color:#FBFBFF;'>;</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>content</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>response</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>code</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>body</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>headers</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>\</span><span style='color:#03DDB2;'>\</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>[</span><span style='color:#03DDB2;'>]</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>is</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>binary</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>body</span><span style='color:#FBFBFF;'>)</span> <span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>body</span> <span style='color:#1098F7;'>=</span> <span style='color:#EAC435;'><i>:erlang</i></span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>bitstring</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>to</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>list</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>body</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>headers</span> <span style='color:#1098F7;'>=</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>code:</span> <span style='color:#FBFBFF;'>code</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>content</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>length:</span> <span style='color:#D7B884;'>Integer.</span><span style='color:#FBFBFF;'>to</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>char</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>list</span><span style='color:#FBFBFF;'>(</span><span style='color:#D7B884;'>IO.</span><span style='color:#FBFBFF;'>iodata</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>length</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>body</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>]</span> <span style='color:#1098F7;'>+</span><span style='color:#1098F7;'>+</span> <span style='color:#FBFBFF;'>headers</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:proceed</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>response:</span> <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:response</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>headers</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>body</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span> <span style='color:#1098F7;'>defmodule</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>Test</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>Frank</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>get</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>"</span> <span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>response</span> <span style='color:#FBFBFF;'>200</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>"</span><span style='color:#1098F7;'><</span><span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>href</span><span style='color:#1098F7;'>=</span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>foo</span><span style='color:#FBFBFF;'>'</span><span style='color:#1098F7;'>></span><span style='color:#FBFBFF;'>go</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>foo</span><span style='color:#1098F7;'><</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>a</span><span style='color:#1098F7;'>></span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>get</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>foo</span><span style='color:#FBFBFF;'>"</span> <span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>response</span> <span style='color:#FBFBFF;'>200</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>foo</span><span style='color:#1098F7;'>!</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span> <span style='color:#D7B884;'>Frank.</span><span style='color:#FBFBFF;'>sing</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>Test</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> </code></pre><br></file>