<style> pre{background-color: #292F36;} </style><file name='dotfiles.ex'ubicacion='media/searchCode/P2/dotfiles.ex'><pre><code> <span style='color:#C19875'> ·</span> <span style='color:#1098F7;'>defmodule</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>GenStage</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@moduledoc</span> <span style='color:#FBFBFF;'>~</span><span style='color:#FBFBFF;'>S</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Stages</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>data</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>exchange</span> <span style='color:#FBFBFF;'>steps</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>send</span> <span style='color:#FBFBFF;'>and</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>receive</span> <span style='color:#FBFBFF;'>data</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>from</span> <span style='color:#FBFBFF;'>other</span> <span style='color:#FBFBFF;'>stages</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>When</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>stage</span> <span style='color:#FBFBFF;'>sends</span> <span style='color:#FBFBFF;'>data</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>acts</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>producer</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>When</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>receives</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>data</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>acts</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Stages</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>take</span> <span style='color:#FBFBFF;'>both</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>and</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>roles</span> <span style='color:#FBFBFF;'>at</span> <span style='color:#FBFBFF;'>once</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># Stage types</i></span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Besides</span> <span style='color:#FBFBFF;'>taking</span> <span style='color:#FBFBFF;'>both</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>roles</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>stage</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>be</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>called</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>source</span><span style='color:#FBFBFF;'>"</span> <span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>only</span> <span style='color:#FBFBFF;'>produces</span> <span style='color:#FBFBFF;'>items</span> <span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>called</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>sink</span><span style='color:#FBFBFF;'>"</span> <span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>it</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>only</span> <span style='color:#FBFBFF;'>consumes</span> <span style='color:#FBFBFF;'>items</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>For</span> <span style='color:#FBFBFF;'>example</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>imagine</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>stages</span> <span style='color:#FBFBFF;'>below</span> <span style='color:#FBFBFF;'>where</span> <span style='color:#FBFBFF;'>A</span> <span style='color:#FBFBFF;'>sends</span> <span style='color:#FBFBFF;'>data</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>B</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>sends</span> <span style='color:#FBFBFF;'>data</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>C:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>A</span><span style='color:#FBFBFF;'>]</span> <span style='color:#1098F7;'>-</span><span style='color:#1098F7;'>></span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>B</span><span style='color:#FBFBFF;'>]</span> <span style='color:#1098F7;'>-</span><span style='color:#1098F7;'>></span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>C</span><span style='color:#FBFBFF;'>]</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>conclude</span> <span style='color:#FBFBFF;'>that:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>A</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>only</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>therefore</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>source</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>B</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>both</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>consumer</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>C</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>only</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>therefore</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>sink</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>As</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>see</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>upcoming</span> <span style='color:#FBFBFF;'>Examples</span> <span style='color:#FBFBFF;'>section</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>must</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>specify</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>type</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>stage</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>implement</span> <span style='color:#FBFBFF;'>each</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>them</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>To</span> <span style='color:#FBFBFF;'>start</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>flow</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>subscribe</span> <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>to</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>producers</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Once</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>communication</span> <span style='color:#FBFBFF;'>channel</span> <span style='color:#FBFBFF;'>between</span> <span style='color:#FBFBFF;'>them</span> <span style='color:#FBFBFF;'>is</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>established</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>ask</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producers</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>We</span> <span style='color:#FBFBFF;'>typically</span> <span style='color:#FBFBFF;'>say</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>sending</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>upstream</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Once</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>arrives</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>emit</span> <span style='color:#FBFBFF;'>items</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>never</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>emitting</span> <span style='color:#FBFBFF;'>more</span> <span style='color:#FBFBFF;'>items</span> <span style='color:#FBFBFF;'>than</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>asked</span> <span style='color:#FBFBFF;'>for</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>This</span> <span style='color:#FBFBFF;'>provides</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>back</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>pressure</span> <span style='color:#FBFBFF;'>mechanism</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>A</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>have</span> <span style='color:#FBFBFF;'>multiple</span> <span style='color:#FBFBFF;'>producers</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>have</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>multiple</span> <span style='color:#FBFBFF;'>consumers</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>When</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>asks</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>data</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>each</span> <span style='color:#FBFBFF;'>producer</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>handled</span> <span style='color:#FBFBFF;'>separately</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>with</span> <span style='color:#FBFBFF;'>its</span> <span style='color:#FBFBFF;'>own</span> <span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>When</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>producer</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>receives</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>sends</span> <span style='color:#FBFBFF;'>data</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>multiple</span> <span style='color:#FBFBFF;'>consumers</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>tracked</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>dispatcher</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>This</span> <span style='color:#FBFBFF;'>allows</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>producers</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>send</span> <span style='color:#FBFBFF;'>data</span> <span style='color:#FBFBFF;'>using</span> <span style='color:#FBFBFF;'>different</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>strategies</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>See</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>Dispatcher</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>more</span> <span style='color:#FBFBFF;'>information</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Many</span> <span style='color:#FBFBFF;'>developers</span> <span style='color:#FBFBFF;'>tend</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>create</span> <span style='color:#FBFBFF;'>layers</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>stages</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>such</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>A</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>B</span> <span style='color:#FBFBFF;'>and</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>C</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>achieving</span> <span style='color:#FBFBFF;'>concurrency</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>If</span> <span style='color:#FBFBFF;'>all</span> <span style='color:#FBFBFF;'>you</span> <span style='color:#FBFBFF;'>want</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>concurrency</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>using</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>processes</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>enough</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>They</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>primitive</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>achieving</span> <span style='color:#FBFBFF;'>concurrency</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>Elixir</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>VM</span> <span style='color:#FBFBFF;'>does</span> <span style='color:#FBFBFF;'>all</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>work</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>multiplexing</span> <span style='color:#FBFBFF;'>them</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Instead</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>layers</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>GenStage</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>created</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>there</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>need</span> <span style='color:#FBFBFF;'>for</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>back</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>pressure</span> <span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>route</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>data</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>different</span> <span style='color:#FBFBFF;'>ways</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>For</span> <span style='color:#FBFBFF;'>example</span><span style='color:#FBFBFF;'>,</span> <span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>you</span> <span style='color:#FBFBFF;'>need</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>data</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>go</span> <span style='color:#FBFBFF;'>over</span> <span style='color:#FBFBFF;'>multiple</span> <span style='color:#FBFBFF;'>steps</span> <span style='color:#FBFBFF;'>but</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>without</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>need</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>back</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>pressure</span> <span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>without</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>need</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>break</span> <span style='color:#FBFBFF;'>the</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>data</span> <span style='color:#FBFBFF;'>apart</span><span style='color:#FBFBFF;'>,</span> <span style='color:#1098F7;'>do</span> <span style='color:#FBFBFF;'>not</span> <span style='color:#FBFBFF;'>design</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>such:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>Producer</span><span style='color:#FBFBFF;'>]</span> <span style='color:#1098F7;'>-</span><span style='color:#1098F7;'>></span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>Step</span> <span style='color:#FBFBFF;'>1</span><span style='color:#FBFBFF;'>]</span> <span style='color:#1098F7;'>-</span><span style='color:#1098F7;'>></span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>Step</span> <span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>]</span> <span style='color:#1098F7;'>-</span><span style='color:#1098F7;'>></span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>Step</span> <span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>]</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Instead</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>better</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>design</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>as:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>                    <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>Consumer</span><span style='color:#FBFBFF;'>]</span>
 <span style='color:#C19875'> ·</span>                   <span style='color:#FBFBFF;'>/</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>Producer</span><span style='color:#FBFBFF;'>]</span><span style='color:#1098F7;'>-</span><span style='color:#1098F7;'><</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>Consumer</span><span style='color:#FBFBFF;'>]</span>
 <span style='color:#C19875'> ·</span>                   <span style='color:#FBFBFF;'>\</span>
 <span style='color:#C19875'> ·</span>                    <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>Consumer</span><span style='color:#FBFBFF;'>]</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>where</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>Consumer</span><span style='color:#FBFBFF;'>"</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>multiple</span> <span style='color:#FBFBFF;'>processes</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>subscribe</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>same</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>Producer</span><span style='color:#FBFBFF;'>"</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>run</span> <span style='color:#FBFBFF;'>exactly</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>same</span> <span style='color:#FBFBFF;'>code</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>with</span> <span style='color:#FBFBFF;'>all</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>transformation</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>steps</span> <span style='color:#FBFBFF;'>from</span> <span style='color:#FBFBFF;'>above</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>In</span> <span style='color:#FBFBFF;'>such</span> <span style='color:#FBFBFF;'>scenarios</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>you</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>even</span> <span style='color:#FBFBFF;'>find</span> <span style='color:#FBFBFF;'>the</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#D7B884;'>Task.</span><span style='color:#FBFBFF;'>async</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>stream</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>function</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>ships</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>part</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>Elixir</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>be</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>enough</span> <span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>achieve</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>flexibility</span> <span style='color:#FBFBFF;'>you</span> <span style='color:#FBFBFF;'>need</span> <span style='color:#FBFBFF;'>with</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>ConsumerSupervisor</span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>functionality</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>included</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>part</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>GenStage</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># Example</i></span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Let</span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>s</span> <span style='color:#FBFBFF;'>define</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>simple</span> <span style='color:#FBFBFF;'>pipeline</span> <span style='color:#FBFBFF;'>below:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>A</span><span style='color:#FBFBFF;'>]</span> <span style='color:#1098F7;'>-</span><span style='color:#1098F7;'>></span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>B</span><span style='color:#FBFBFF;'>]</span> <span style='color:#1098F7;'>-</span><span style='color:#1098F7;'>></span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>C</span><span style='color:#FBFBFF;'>]</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>where</span> <span style='color:#FBFBFF;'>A</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>emit</span> <span style='color:#FBFBFF;'>items</span> <span style='color:#FBFBFF;'>starting</span> <span style='color:#FBFBFF;'>from</span> <span style='color:#FBFBFF;'>0</span><span style='color:#FBFBFF;'>,</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>B</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>producer</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>receive</span> <span style='color:#FBFBFF;'>those</span> <span style='color:#FBFBFF;'>items</span> <span style='color:#FBFBFF;'>and</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>multiply</span> <span style='color:#FBFBFF;'>them</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>given</span> <span style='color:#FBFBFF;'>number</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>C</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>receive</span> <span style='color:#FBFBFF;'>those</span> <span style='color:#FBFBFF;'>events</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>print</span> <span style='color:#FBFBFF;'>them</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>terminal</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Let</span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>s</span> <span style='color:#FBFBFF;'>start</span> <span style='color:#FBFBFF;'>with</span> <span style='color:#FBFBFF;'>A</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Since</span> <span style='color:#FBFBFF;'>A</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>producer</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>its</span> <span style='color:#FBFBFF;'>main</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>responsibility</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>receive</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>generate</span> <span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Those</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>memory</span> <span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>an</span> <span style='color:#FBFBFF;'>external</span> <span style='color:#FBFBFF;'>queue</span> <span style='color:#FBFBFF;'>system</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>For</span> <span style='color:#FBFBFF;'>simplicity</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>let</span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>s</span> <span style='color:#FBFBFF;'>implement</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>simple</span> <span style='color:#FBFBFF;'>counter</span> <span style='color:#FBFBFF;'>starting</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>from</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>given</span> <span style='color:#FBFBFF;'>value</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>counter</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>received</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>init</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>1</span><span style='color:#FBFBFF;'>`</span><span style='color:#1098F7;'>:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>defmodule</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>A</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>GenStage</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>start</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>link</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>number</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>A</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>number</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>init</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>counter</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>counter</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>handle</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>demand</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>demand</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>counter</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>when</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>demand</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>></span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>0</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#565857;'><i># If the counter is 3 and we ask for 2 items, we will</i></span>
 <span style='color:#C19875'> ·</span>           <span style='color:#565857;'><i># emit the items 3 and 4, and set the state to 5.</i></span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>events</span> <span style='color:#1098F7;'>=</span> <span style='color:#D7B884;'>Enum.</span><span style='color:#FBFBFF;'>to</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>list</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>counter</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>counter</span><span style='color:#1098F7;'>+</span><span style='color:#FBFBFF;'>demand</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>1</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>counter</span> <span style='color:#1098F7;'>+</span> <span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>B</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>producer</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>This</span> <span style='color:#FBFBFF;'>means</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>does</span> <span style='color:#FBFBFF;'>not</span> <span style='color:#FBFBFF;'>explicitly</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>handle</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>because</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>always</span> <span style='color:#FBFBFF;'>forwarded</span> <span style='color:#FBFBFF;'>to</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>its</span> <span style='color:#FBFBFF;'>producer</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Once</span> <span style='color:#FBFBFF;'>A</span> <span style='color:#FBFBFF;'>receives</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>from</span> <span style='color:#FBFBFF;'>B</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>send</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>B</span> <span style='color:#FBFBFF;'>which</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>transformed</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>B</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>desired</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>In</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>our</span> <span style='color:#FBFBFF;'>case</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>B</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>receive</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>multiply</span> <span style='color:#FBFBFF;'>them</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>number</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>given</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>initialization</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>stored</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>state:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>defmodule</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>B</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>GenStage</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>start</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>link</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>number</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>B</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>number</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>init</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>number</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>number</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>handle</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>events</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>events</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>_</span><span style='color:#03DDB2;'>from</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>number</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>events</span> <span style='color:#1098F7;'>=</span> <span style='color:#D7B884;'>Enum.</span><span style='color:#FBFBFF;'>map</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>&</span> <span style='color:#FBFBFF;'>&</span><span style='color:#FBFBFF;'>1</span> <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>number</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>number</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>C</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>finally</span> <span style='color:#FBFBFF;'>receive</span> <span style='color:#FBFBFF;'>those</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>print</span> <span style='color:#FBFBFF;'>them</span> <span style='color:#FBFBFF;'>every</span> <span style='color:#FBFBFF;'>second</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>terminal:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>defmodule</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>C</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>GenStage</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>start</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>link</span><span style='color:#9A8BBB;'>(</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>C</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>init</span><span style='color:#9A8BBB;'>(</span><span style='color:#EAC435;'>:ok</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:consumer</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:the</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>does</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>not</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>matter</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>handle</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>events</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>events</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>_</span><span style='color:#03DDB2;'>from</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>state</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#565857;'><i># Wait for a second.</i></span>
 <span style='color:#C19875'> ·</span>           <span style='color:#D7B884;'>Process.</span><span style='color:#FBFBFF;'>sleep</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>1000</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>           <span style='color:#565857;'><i># Inspect the events.</i></span>
 <span style='color:#C19875'> ·</span>           <span style='color:#D7B884;'>IO.</span><span style='color:#FBFBFF;'>inspect</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>           <span style='color:#565857;'><i># We are a consumer, so we would never emit items.</i></span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Now</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>can</span> <span style='color:#FBFBFF;'>start</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>connect</span> <span style='color:#FBFBFF;'>them:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>a</span><span style='color:#FBFBFF;'>}</span> <span style='color:#1098F7;'>=</span> <span style='color:#FBFBFF;'>A</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>0</span><span style='color:#FBFBFF;'>)</span>  <span style='color:#565857;'><i># starting from zero</i></span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>b</span><span style='color:#FBFBFF;'>}</span> <span style='color:#1098F7;'>=</span> <span style='color:#FBFBFF;'>B</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>)</span>  <span style='color:#565857;'><i># multiply by 2</i></span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>c</span><span style='color:#FBFBFF;'>}</span> <span style='color:#1098F7;'>=</span> <span style='color:#FBFBFF;'>C</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>)</span>   <span style='color:#565857;'><i># state does not matter</i></span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>sync</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>subscribe</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>c</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>to:</span> <span style='color:#FBFBFF;'>b</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>sync</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>subscribe</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>b</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>to:</span> <span style='color:#FBFBFF;'>a</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Typically</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>subscribe</span> <span style='color:#FBFBFF;'>from</span> <span style='color:#FBFBFF;'>bottom</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>top</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Since</span> <span style='color:#FBFBFF;'>A</span> <span style='color:#FBFBFF;'>will</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>start</span> <span style='color:#FBFBFF;'>producing</span> <span style='color:#FBFBFF;'>items</span> <span style='color:#FBFBFF;'>only</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>B</span> <span style='color:#FBFBFF;'>connects</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>it</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>want</span> <span style='color:#FBFBFF;'>this</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>subscription</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>happen</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>whole</span> <span style='color:#FBFBFF;'>pipeline</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>ready</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>After</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>you</span> <span style='color:#FBFBFF;'>subscribe</span> <span style='color:#FBFBFF;'>all</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>them</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>start</span> <span style='color:#FBFBFF;'>flowing</span> <span style='color:#FBFBFF;'>upstream</span> <span style='color:#FBFBFF;'>and</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>downstream</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>When</span> <span style='color:#FBFBFF;'>implementing</span> <span style='color:#FBFBFF;'>consumers</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>often</span> <span style='color:#FBFBFF;'>set</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:max</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:min</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:max</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>specifies</span> <span style='color:#FBFBFF;'>the</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>maximum</span> <span style='color:#FBFBFF;'>amount</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>flow</span> <span style='color:#FBFBFF;'>while</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:min</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>specifies</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>minimum</span> <span style='color:#FBFBFF;'>threshold</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>trigger</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>more</span> <span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>For</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>example</span><span style='color:#FBFBFF;'>,</span> <span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:max</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>1000</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:min</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>750</span><span style='color:#FBFBFF;'>,</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>ask</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>1000</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>initially</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>ask</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>more</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>only</span> <span style='color:#FBFBFF;'>after</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>receives</span> <span style='color:#FBFBFF;'>at</span> <span style='color:#FBFBFF;'>least</span> <span style='color:#FBFBFF;'>250</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>In</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>example</span> <span style='color:#FBFBFF;'>above</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>B</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>therefore</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>acts</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>buffer</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Getting</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>proper</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>values</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>B</span> <span style='color:#FBFBFF;'>is</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>important:</span> <span style='color:#FBFBFF;'>making</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>buffer</span> <span style='color:#FBFBFF;'>too</span> <span style='color:#FBFBFF;'>small</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>make</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>whole</span> <span style='color:#FBFBFF;'>pipeline</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>slower</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>making</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>buffer</span> <span style='color:#FBFBFF;'>too</span> <span style='color:#FBFBFF;'>big</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>unnecessarily</span> <span style='color:#FBFBFF;'>consume</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>memory</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>When</span> <span style='color:#FBFBFF;'>such</span> <span style='color:#FBFBFF;'>values</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>applied</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>stages</span> <span style='color:#FBFBFF;'>above</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>easy</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>see</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>works</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>batches</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>A</span> <span style='color:#FBFBFF;'>ends</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>up</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>emitting</span> <span style='color:#FBFBFF;'>batches</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>50</span> <span style='color:#FBFBFF;'>items</span> <span style='color:#FBFBFF;'>which</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>take</span> <span style='color:#FBFBFF;'>approximately</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>50</span> <span style='color:#FBFBFF;'>seconds</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>consumed</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>C</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>which</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>then</span> <span style='color:#FBFBFF;'>request</span> <span style='color:#FBFBFF;'>another</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>batch</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>50</span> <span style='color:#FBFBFF;'>items</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># </i></span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>init</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:subscribe</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>to</span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>In</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>example</span> <span style='color:#FBFBFF;'>above</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>have</span> <span style='color:#FBFBFF;'>started</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>processes</span> <span style='color:#FBFBFF;'>A</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>B</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>C</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>independently</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>subscribed</span> <span style='color:#FBFBFF;'>them</span> <span style='color:#FBFBFF;'>later</span> <span style='color:#FBFBFF;'>on</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>But</span> <span style='color:#FBFBFF;'>most</span> <span style='color:#FBFBFF;'>often</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>is</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>simpler</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>subscribe</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>its</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>its</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:init</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>1</span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>callback</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>This</span> <span style='color:#FBFBFF;'>way</span><span style='color:#FBFBFF;'>,</span> <span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>crashes</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>restarting</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>automatically</span> <span style='color:#FBFBFF;'>re</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>invoke</span> <span style='color:#FBFBFF;'>its</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:init</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>1</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>callback</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>resubscribe</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>supervisor</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>This</span> <span style='color:#FBFBFF;'>approach</span> <span style='color:#FBFBFF;'>works</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>long</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>can</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>referenced</span> <span style='color:#FBFBFF;'>when</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>starts</span><span style='color:#1098F7;'>-</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>such</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>name</span> <span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>named</span> <span style='color:#FBFBFF;'>process</span><span style='color:#FBFBFF;'>)</span> <span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>pid</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>running</span> <span style='color:#FBFBFF;'>unnamed</span> <span style='color:#FBFBFF;'>process</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>For</span> <span style='color:#FBFBFF;'>example</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>assuming</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>process</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>A</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>B</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>started</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>follows:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#565857;'><i># Let</i></span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>s</span> <span style='color:#FBFBFF;'>call</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>stage</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>module</span> <span style='color:#FBFBFF;'>A</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>A</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>A</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>0</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>name:</span> <span style='color:#FBFBFF;'>A</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#565857;'><i># Let</i></span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>s</span> <span style='color:#FBFBFF;'>call</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>stage</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>module</span> <span style='color:#FBFBFF;'>B</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>B</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>B</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>name:</span> <span style='color:#FBFBFF;'>B</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#565857;'><i># No need to name consumers as they won</i></span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>t</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>subscribed</span> <span style='color:#FBFBFF;'>to</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>C</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>We</span> <span style='color:#FBFBFF;'>can</span> <span style='color:#FBFBFF;'>now</span> <span style='color:#FBFBFF;'>change</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:init</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>1</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>callback</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>C</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>following:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>init</span><span style='color:#9A8BBB;'>(</span><span style='color:#EAC435;'>:ok</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:consumer</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:the</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>does</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>not</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>matter</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>subscribe</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>to:</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>B</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>or:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>init</span><span style='color:#9A8BBB;'>(</span><span style='color:#EAC435;'>:ok</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:consumer</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:the</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>does</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>not</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>matter</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>subscribe</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>to:</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>B</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>options</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>And</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>no</span> <span style='color:#FBFBFF;'>longer</span> <span style='color:#FBFBFF;'>need</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>call</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>sync</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>subscribe</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Another</span> <span style='color:#FBFBFF;'>advantage</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>this</span> <span style='color:#FBFBFF;'>approach</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>makes</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>straight</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>forward</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>leverage</span> <span style='color:#FBFBFF;'>concurrency</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>simply</span> <span style='color:#FBFBFF;'>starting</span> <span style='color:#FBFBFF;'>multiple</span> <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>subscribe</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>their</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>producer</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>This</span> <span style='color:#FBFBFF;'>can</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>done</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>example</span> <span style='color:#FBFBFF;'>above</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>simply</span> <span style='color:#FBFBFF;'>calling</span> <span style='color:#FBFBFF;'>start</span> <span style='color:#FBFBFF;'>link</span> <span style='color:#FBFBFF;'>multiple</span> <span style='color:#FBFBFF;'>times:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#565857;'><i># Start 4 consumers</i></span>
 <span style='color:#C19875'> ·</span>       <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>C</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>C</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>C</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>C</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>In</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>supervision</span> <span style='color:#FBFBFF;'>tree</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>this</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>often</span> <span style='color:#FBFBFF;'>done</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>starting</span> <span style='color:#FBFBFF;'>multiple</span> <span style='color:#FBFBFF;'>workers:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>children</span> <span style='color:#1098F7;'>=</span> <span style='color:#FBFBFF;'>[</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>worker</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>A</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>0</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>,</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>worker</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>B</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>,</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>worker</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>C</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>,</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>worker</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>C</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>,</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>worker</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>C</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>,</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>worker</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>C</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>]</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#D7B884;'>Supervisor.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>children</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>strategy:</span> <span style='color:#EAC435;'><i>:one</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>for</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>one</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>In</span> <span style='color:#FBFBFF;'>fact</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>having</span> <span style='color:#FBFBFF;'>multiple</span> <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>often</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>easiest</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>simplest</span> <span style='color:#FBFBFF;'>way</span> <span style='color:#FBFBFF;'>to</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>leverage</span> <span style='color:#FBFBFF;'>concurrency</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>GenStage</span> <span style='color:#FBFBFF;'>pipeline</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>especially</span> <span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>can</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>processed</span> <span style='color:#FBFBFF;'>out</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>order</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>For</span> <span style='color:#FBFBFF;'>example</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>imagine</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>scenario</span> <span style='color:#FBFBFF;'>where</span> <span style='color:#FBFBFF;'>you</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>have</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>stream</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>incoming</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>you</span> <span style='color:#FBFBFF;'>need</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>access</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>number</span> <span style='color:#FBFBFF;'>of</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>external</span> <span style='color:#FBFBFF;'>services</span> <span style='color:#FBFBFF;'>per</span> <span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Instead</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>building</span> <span style='color:#FBFBFF;'>complex</span> <span style='color:#FBFBFF;'>stages</span> <span style='color:#FBFBFF;'>that</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>route</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>through</span> <span style='color:#FBFBFF;'>those</span> <span style='color:#FBFBFF;'>services</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>one</span> <span style='color:#FBFBFF;'>simple</span> <span style='color:#FBFBFF;'>mechanism</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>leverage</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>concurrency</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>start</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>N</span> <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>invoke</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>external</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>services</span> <span style='color:#FBFBFF;'>directly</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>each</span> <span style='color:#FBFBFF;'>event</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>each</span> <span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>N</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>typically</span> <span style='color:#FBFBFF;'>the</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>number</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>cores</span> <span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>returned</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>`</span><span style='color:#D7B884;'>System.</span><span style='color:#FBFBFF;'>schedulers</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>online</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>0</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>)</span> <span style='color:#FBFBFF;'>but</span> <span style='color:#FBFBFF;'>can</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>likely</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>increased</span> <span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>mostly</span> <span style='color:#FBFBFF;'>waiting</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#D7B884;'>IO.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Another</span> <span style='color:#FBFBFF;'>alternative</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>scenario</span> <span style='color:#FBFBFF;'>above</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>ConsumerSupervisor</span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>consuming</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>instead</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>N</span> <span style='color:#FBFBFF;'>consumers</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>ConsumerSupervisor</span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>start</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>separate</span> <span style='color:#FBFBFF;'>supervised</span> <span style='color:#FBFBFF;'>process</span> <span style='color:#FBFBFF;'>per</span> <span style='color:#FBFBFF;'>event</span> <span style='color:#FBFBFF;'>where</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>number</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>children</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>at</span> <span style='color:#FBFBFF;'>most</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>max</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>average</span> <span style='color:#FBFBFF;'>amount</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>children</span> <span style='color:#FBFBFF;'>is</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>max</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span> <span style='color:#1098F7;'>-</span> <span style='color:#FBFBFF;'>min</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>)</span> <span style='color:#FBFBFF;'>/</span> <span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># Buffering</i></span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>In</span> <span style='color:#FBFBFF;'>many</span> <span style='color:#FBFBFF;'>situations</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>producers</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>attempt</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>emit</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>while</span> <span style='color:#FBFBFF;'>no</span> <span style='color:#FBFBFF;'>consumers</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>have</span> <span style='color:#FBFBFF;'>yet</span> <span style='color:#FBFBFF;'>subscribed</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Similarly</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>ask</span> <span style='color:#FBFBFF;'>producers</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>events</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>not</span> <span style='color:#FBFBFF;'>yet</span> <span style='color:#FBFBFF;'>available</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>In</span> <span style='color:#FBFBFF;'>such</span> <span style='color:#FBFBFF;'>cases</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>necessary</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>producers</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>buffer</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>until</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>available</span> <span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>buffer</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>until</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>arrive</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>respectively</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>As</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>see</span> <span style='color:#FBFBFF;'>next</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>buffering</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>can</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>done</span> <span style='color:#FBFBFF;'>automatically</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>GenStage</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>while</span> <span style='color:#FBFBFF;'>buffering</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>case</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>explicitly</span> <span style='color:#FBFBFF;'>considered</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>developers</span> <span style='color:#FBFBFF;'>implementing</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>producers</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># Buffering events</i></span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Due</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>concurrent</span> <span style='color:#FBFBFF;'>nature</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>Elixir</span> <span style='color:#FBFBFF;'>software</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>sometimes</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>producer</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>dispatch</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>without</span> <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>send</span> <span style='color:#FBFBFF;'>those</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>to</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>For</span> <span style='color:#FBFBFF;'>example</span><span style='color:#FBFBFF;'>,</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>imagine</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:consumer</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>B</span> <span style='color:#FBFBFF;'>subscribes</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>A</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Next</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>B</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>sends</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>A</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>which</span> <span style='color:#FBFBFF;'>starts</span> <span style='color:#FBFBFF;'>producing</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>satisfy</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Now</span><span style='color:#FBFBFF;'>,</span> <span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>B</span> <span style='color:#FBFBFF;'>crashes</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>attempt</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>dispatch</span> <span style='color:#FBFBFF;'>the</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>now</span> <span style='color:#FBFBFF;'>produced</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>but</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>no</span> <span style='color:#FBFBFF;'>longer</span> <span style='color:#FBFBFF;'>has</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>send</span> <span style='color:#FBFBFF;'>those</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>to</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>In</span> <span style='color:#FBFBFF;'>such</span> <span style='color:#FBFBFF;'>cases</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>automatically</span> <span style='color:#FBFBFF;'>buffer</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>until</span> <span style='color:#FBFBFF;'>another</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>subscribes</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>buffer</span> <span style='color:#FBFBFF;'>can</span> <span style='color:#FBFBFF;'>also</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>used</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>cases</span> <span style='color:#FBFBFF;'>where</span> <span style='color:#FBFBFF;'>external</span> <span style='color:#FBFBFF;'>sources</span> <span style='color:#FBFBFF;'>only</span> <span style='color:#FBFBFF;'>send</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>batches</span> <span style='color:#FBFBFF;'>larger</span> <span style='color:#FBFBFF;'>than</span> <span style='color:#FBFBFF;'>asked</span> <span style='color:#FBFBFF;'>for</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>For</span> <span style='color:#FBFBFF;'>example</span><span style='color:#FBFBFF;'>,</span> <span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>you</span> <span style='color:#FBFBFF;'>are</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>receiving</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>from</span> <span style='color:#FBFBFF;'>an</span> <span style='color:#FBFBFF;'>external</span> <span style='color:#FBFBFF;'>source</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>only</span> <span style='color:#FBFBFF;'>sends</span> <span style='color:#FBFBFF;'>events</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>batches</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>1000</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>internal</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>smaller</span> <span style='color:#FBFBFF;'>than</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>that</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>buffer</span> <span style='color:#FBFBFF;'>allows</span> <span style='color:#FBFBFF;'>you</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>always</span> <span style='color:#FBFBFF;'>emit</span> <span style='color:#FBFBFF;'>batches</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>1000</span> <span style='color:#FBFBFF;'>events</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>even</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>has</span> <span style='color:#FBFBFF;'>asked</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>less</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>In</span> <span style='color:#FBFBFF;'>all</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>those</span> <span style='color:#FBFBFF;'>cases</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>an</span> <span style='color:#FBFBFF;'>event</span> <span style='color:#FBFBFF;'>cannot</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>immediately</span> <span style='color:#FBFBFF;'>by</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>producer</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>event</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>automatically</span> <span style='color:#FBFBFF;'>stored</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>next</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>time</span> <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>ask</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>size</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>buffer</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>configured</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>via</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:buffer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>size</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>option</span> <span style='color:#FBFBFF;'>returned</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>init</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>1</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>default</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>value</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>10</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>0</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>If</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>buffer</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>size</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>exceeded</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>an</span> <span style='color:#FBFBFF;'>error</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>logged</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>See</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>documentation</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:init</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>1</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>more</span> <span style='color:#FBFBFF;'>detailed</span> <span style='color:#FBFBFF;'>infromation</span> <span style='color:#FBFBFF;'>about</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:buffer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>size</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>option</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># Buffering demand</i></span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>In</span> <span style='color:#FBFBFF;'>case</span> <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>send</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>not</span> <span style='color:#FBFBFF;'>yet</span> <span style='color:#FBFBFF;'>ready</span> <span style='color:#FBFBFF;'>to</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>fill</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>producers</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>buffer</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>until</span> <span style='color:#FBFBFF;'>data</span> <span style='color:#FBFBFF;'>arrives</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>As</span> <span style='color:#FBFBFF;'>an</span> <span style='color:#FBFBFF;'>example</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>let</span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>s</span> <span style='color:#FBFBFF;'>implement</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>broadcasts</span> <span style='color:#FBFBFF;'>messages</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>consumers</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>For</span> <span style='color:#FBFBFF;'>producers</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>need</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>consider</span> <span style='color:#FBFBFF;'>two</span> <span style='color:#FBFBFF;'>scenarios:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>1</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>what</span> <span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>arrive</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>there</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>no</span> <span style='color:#FBFBFF;'>consumers?</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>what</span> <span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>send</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>there</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>not</span> <span style='color:#FBFBFF;'>enough</span> <span style='color:#FBFBFF;'>events?</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>One</span> <span style='color:#FBFBFF;'>way</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>implement</span> <span style='color:#FBFBFF;'>such</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>broadcaster</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>simply</span> <span style='color:#FBFBFF;'>rely</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>internal</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>buffer</span> <span style='color:#FBFBFF;'>available</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>GenStage</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>dispatching</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>they</span> <span style='color:#FBFBFF;'>arrive</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>explained</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>previous</span> <span style='color:#FBFBFF;'>section:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>defmodule</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>Broadcaster</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>GenStage</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#C73E1D;'>@doc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>Starts</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>broadcaster</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>start</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>link</span><span style='color:#9A8BBB;'>(</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>MODULE</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>name:</span> <span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>MODULE</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#C73E1D;'>@doc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>Sends</span> <span style='color:#FBFBFF;'>an</span> <span style='color:#FBFBFF;'>event</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>returns</span> <span style='color:#FBFBFF;'>only</span> <span style='color:#FBFBFF;'>after</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>event</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>dispatched</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>sync</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>notify</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>event</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>timeout</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>\</span><span style='color:#03DDB2;'>\</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>5000</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>call</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>MODULE</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:notify</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>timeout</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>init</span><span style='color:#9A8BBB;'>(</span><span style='color:#EAC435;'>:ok</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>dispatcher:</span> <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>BroadcastDispatcher</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>handle</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>call</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>{</span><span style='color:#EAC435;'>:notify</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>event</span><span style='color:#03DDB2;'>}</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>_</span><span style='color:#03DDB2;'>from</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>state</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:reply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span> <span style='color:#565857;'><i># Dispatch immediately</i></span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>handle</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>demand</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>_</span><span style='color:#03DDB2;'>demand</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>state</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span> <span style='color:#565857;'><i># We don</i></span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>t</span> <span style='color:#FBFBFF;'>care</span> <span style='color:#FBFBFF;'>about</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>By</span> <span style='color:#FBFBFF;'>always</span> <span style='color:#FBFBFF;'>sending</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>soon</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>they</span> <span style='color:#FBFBFF;'>arrive</span><span style='color:#FBFBFF;'>,</span> <span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>there</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>any</span> <span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>,</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>serve</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>existing</span> <span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>otherwise</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>event</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>queued</span> <span style='color:#FBFBFF;'>in</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>GenStage</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>s</span> <span style='color:#FBFBFF;'>internal</span> <span style='color:#FBFBFF;'>buffer</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>In</span> <span style='color:#FBFBFF;'>case</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>being</span> <span style='color:#FBFBFF;'>queued</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>not</span> <span style='color:#FBFBFF;'>being</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>consumed</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>log</span> <span style='color:#FBFBFF;'>message</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>emitted</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>exceed</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:buffer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>size</span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>configuration</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>While</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>implementation</span> <span style='color:#FBFBFF;'>above</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>enough</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>solve</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>constraints</span> <span style='color:#FBFBFF;'>above</span><span style='color:#FBFBFF;'>,</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>more</span> <span style='color:#FBFBFF;'>robust</span> <span style='color:#FBFBFF;'>implementation</span> <span style='color:#FBFBFF;'>would</span> <span style='color:#FBFBFF;'>have</span> <span style='color:#FBFBFF;'>tighter</span> <span style='color:#FBFBFF;'>control</span> <span style='color:#FBFBFF;'>over</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>events</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>tracking</span> <span style='color:#FBFBFF;'>this</span> <span style='color:#FBFBFF;'>data</span> <span style='color:#FBFBFF;'>locally</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>leaving</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>GenStage</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>internal</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>buffer</span> <span style='color:#FBFBFF;'>only</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>cases</span> <span style='color:#FBFBFF;'>where</span> <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>crash</span> <span style='color:#FBFBFF;'>without</span> <span style='color:#FBFBFF;'>consuming</span> <span style='color:#FBFBFF;'>all</span> <span style='color:#FBFBFF;'>data</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>To</span> <span style='color:#FBFBFF;'>handle</span> <span style='color:#FBFBFF;'>such</span> <span style='color:#FBFBFF;'>cases</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>two</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>element</span> <span style='color:#FBFBFF;'>tuple</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>broadcaster</span> <span style='color:#FBFBFF;'>state</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>where</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>first</span> <span style='color:#FBFBFF;'>elemeent</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>queue</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>second</span> <span style='color:#FBFBFF;'>element</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>pending</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>.</span>  <span style='color:#FBFBFF;'>When</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>arrive</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>there</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>no</span> <span style='color:#FBFBFF;'>consumers</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>store</span> <span style='color:#FBFBFF;'>the</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>event</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>queue</span> <span style='color:#FBFBFF;'>alongside</span> <span style='color:#FBFBFF;'>information</span> <span style='color:#FBFBFF;'>about</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>process</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>broadcasted</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>When</span> <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>send</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>there</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>not</span> <span style='color:#FBFBFF;'>enough</span> <span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>will</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>increase</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>pending</span> <span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>.</span>  <span style='color:#FBFBFF;'>Once</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>have</span> <span style='color:#FBFBFF;'>both</span> <span style='color:#FBFBFF;'>data</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>we</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>acknowledge</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>process</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>has</span> <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>event</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>broadcaster</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>finally</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>broadcast</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>event</span> <span style='color:#FBFBFF;'>downstream</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>defmodule</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>QueueBroadcaster</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>GenStage</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#C73E1D;'>@doc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>Starts</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>broadcaster</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>start</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>link</span><span style='color:#9A8BBB;'>(</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>MODULE</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>name:</span> <span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>MODULE</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#C73E1D;'>@doc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>Sends</span> <span style='color:#FBFBFF;'>an</span> <span style='color:#FBFBFF;'>event</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>returns</span> <span style='color:#FBFBFF;'>only</span> <span style='color:#FBFBFF;'>after</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>event</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>dispatched</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>sync</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>notify</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>event</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>timeout</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>\</span><span style='color:#03DDB2;'>\</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>5000</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>call</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>MODULE</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:notify</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>timeout</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># Callbacks</i></span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>init</span><span style='color:#9A8BBB;'>(</span><span style='color:#EAC435;'>:ok</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:queue</i></span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>0</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>dispatcher:</span> <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>BroadcastDispatcher</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>handle</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>call</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>{</span><span style='color:#EAC435;'>:notify</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>event</span><span style='color:#03DDB2;'>}</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>from</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>{</span><span style='color:#03DDB2;'>queue</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>pending</span><span style='color:#03DDB2;'>_</span><span style='color:#03DDB2;'>demand</span><span style='color:#03DDB2;'>}</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>queue</span> <span style='color:#1098F7;'>=</span> <span style='color:#EAC435;'><i>:queue</i></span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>in</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>queue</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>dispatch</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>queue</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>pending</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>handle</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>demand</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>incoming</span><span style='color:#03DDB2;'>_</span><span style='color:#03DDB2;'>demand</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>{</span><span style='color:#03DDB2;'>queue</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>pending</span><span style='color:#03DDB2;'>_</span><span style='color:#03DDB2;'>demand</span><span style='color:#03DDB2;'>}</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>dispatch</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>queue</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>incoming</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span> <span style='color:#1098F7;'>+</span> <span style='color:#FBFBFF;'>pending</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>defp</span> <span style='color:#FBFBFF;'>dispatch</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>queue</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>0</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>)</span> <span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#D7B884;'>Enum.</span><span style='color:#FBFBFF;'>reverse</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>queue</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>0</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>defp</span> <span style='color:#FBFBFF;'>dispatch</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>queue</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>)</span> <span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>case</span> <span style='color:#EAC435;'><i>:queue</i></span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>out</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>queue</span><span style='color:#FBFBFF;'>)</span> <span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>             <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:value</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>queue</span><span style='color:#FBFBFF;'>}</span> <span style='color:#1098F7;'>-</span><span style='color:#1098F7;'>></span>
 <span style='color:#C19875'> ·</span>               <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>reply</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>               <span style='color:#FBFBFF;'>dispatch</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>queue</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#1098F7;'>-</span> <span style='color:#FBFBFF;'>1</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span> <span style='color:#FBFBFF;'>|</span> <span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>             <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:empty</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>queue</span><span style='color:#FBFBFF;'>}</span> <span style='color:#1098F7;'>-</span><span style='color:#1098F7;'>></span>
 <span style='color:#C19875'> ·</span>               <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#D7B884;'>Enum.</span><span style='color:#FBFBFF;'>reverse</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>queue</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Let</span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>s</span> <span style='color:#FBFBFF;'>also</span> <span style='color:#FBFBFF;'>implement</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>automatically</span> <span style='color:#FBFBFF;'>subscribes</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>broadcaster</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:init</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>1</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>advantage</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>doing</span> <span style='color:#FBFBFF;'>so</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>initialization</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>that</span><span style='color:#FBFBFF;'>,</span> <span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>crashes</span> <span style='color:#FBFBFF;'>while</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>supervised</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>subscription</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>automatically</span> <span style='color:#FBFBFF;'>re</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>established</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>supervisor</span> <span style='color:#FBFBFF;'>restarts</span> <span style='color:#FBFBFF;'>it</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>defmodule</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>Printer</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>GenStage</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#C73E1D;'>@doc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>Starts</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>start</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>link</span><span style='color:#9A8BBB;'>(</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>MODULE</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>init</span><span style='color:#9A8BBB;'>(</span><span style='color:#EAC435;'>:ok</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#565857;'><i># Starts a permanent subscription to the broadcaster</i></span>
 <span style='color:#C19875'> ·</span>           <span style='color:#565857;'><i># which will automatically start requesting items.</i></span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:consumer</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>subscribe</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>to:</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>QueueBroadcaster</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>handle</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>events</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>events</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>_</span><span style='color:#03DDB2;'>from</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>state</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>event</span> <span style='color:#1098F7;'><</span><span style='color:#1098F7;'>-</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>             <span style='color:#D7B884;'>IO.</span><span style='color:#FBFBFF;'>inspect</span> <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>self</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>With</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>broadcaster</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>hand</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>now</span> <span style='color:#FBFBFF;'>let</span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>s</span> <span style='color:#FBFBFF;'>start</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>well</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>multiple</span> <span style='color:#FBFBFF;'>consumers:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#565857;'><i># Start the producer</i></span>
 <span style='color:#C19875'> ·</span>       <span style='color:#D7B884;'>QueueBroadcaster.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#565857;'><i># Start multiple consumers</i></span>
 <span style='color:#C19875'> ·</span>       <span style='color:#D7B884;'>Printer.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#D7B884;'>Printer.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#D7B884;'>Printer.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#D7B884;'>Printer.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>At</span> <span style='color:#FBFBFF;'>this</span> <span style='color:#FBFBFF;'>point</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>all</span> <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>have</span> <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>their</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>which</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>were</span> <span style='color:#FBFBFF;'>not</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>able</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>fulfill</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Now</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>calling</span> <span style='color:#FBFBFF;'>`</span><span style='color:#D7B884;'>QueueBroadcaster.</span><span style='color:#FBFBFF;'>sync</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>notify</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>1</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>event</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>shall</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>broadcasted</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>all</span> <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>at</span> <span style='color:#FBFBFF;'>once</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>have</span> <span style='color:#FBFBFF;'>buffered</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#D7B884;'>QueueBroadcaster.</span><span style='color:#FBFBFF;'>sync</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>notify</span><span style='color:#FBFBFF;'>(</span><span style='color:#EAC435;'><i>:hello</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>world</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>If</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>had</span> <span style='color:#FBFBFF;'>called</span> <span style='color:#FBFBFF;'>`</span><span style='color:#D7B884;'>QueueBroadcaster.</span><span style='color:#FBFBFF;'>sync</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>notify</span><span style='color:#FBFBFF;'>(</span><span style='color:#EAC435;'><i>:hello</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>world</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>before</span> <span style='color:#FBFBFF;'>any</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>was</span> <span style='color:#FBFBFF;'>available</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>event</span> <span style='color:#FBFBFF;'>would</span> <span style='color:#FBFBFF;'>also</span> <span style='color:#FBFBFF;'>have</span> <span style='color:#FBFBFF;'>been</span> <span style='color:#FBFBFF;'>buffered</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>our</span> <span style='color:#FBFBFF;'>own</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>queue</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>served</span> <span style='color:#FBFBFF;'>only</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>had</span> <span style='color:#FBFBFF;'>been</span> <span style='color:#FBFBFF;'>received</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>By</span> <span style='color:#FBFBFF;'>having</span> <span style='color:#FBFBFF;'>control</span> <span style='color:#FBFBFF;'>over</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>queue</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>broadcaster</span> <span style='color:#FBFBFF;'>has</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>full</span> <span style='color:#FBFBFF;'>control</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>how</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>behave</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>there</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>no</span> <span style='color:#FBFBFF;'>consumers</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>the</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>queue</span> <span style='color:#FBFBFF;'>grows</span> <span style='color:#FBFBFF;'>too</span> <span style='color:#FBFBFF;'>large</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>so</span> <span style='color:#FBFBFF;'>forth</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># Asynchronous work and </i></span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>subscribe</span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Both</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:consumer</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>stages</span> <span style='color:#FBFBFF;'>have</span> <span style='color:#FBFBFF;'>been</span> <span style='color:#FBFBFF;'>designed</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>their</span> <span style='color:#FBFBFF;'>work</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>callback</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>This</span> <span style='color:#FBFBFF;'>means</span> <span style='color:#FBFBFF;'>that</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>after</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>invoked</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>both</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:consumer</i></span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>stages</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>immediately</span> <span style='color:#FBFBFF;'>send</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>upstream</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>ask</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>more</span> <span style='color:#FBFBFF;'>items</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>the</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>stage</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>produced</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>assumes</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>have</span> <span style='color:#FBFBFF;'>been</span> <span style='color:#FBFBFF;'>fully</span> <span style='color:#FBFBFF;'>processed</span> <span style='color:#FBFBFF;'>by</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Such</span> <span style='color:#FBFBFF;'>default</span> <span style='color:#FBFBFF;'>behaviour</span> <span style='color:#FBFBFF;'>makes</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:consumer</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>stages</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>unfeasible</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>doing</span> <span style='color:#FBFBFF;'>asynchronous</span> <span style='color:#FBFBFF;'>work</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>However</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>given</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>GenStage</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>was</span> <span style='color:#FBFBFF;'>designed</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>run</span> <span style='color:#FBFBFF;'>with</span> <span style='color:#FBFBFF;'>multiple</span> <span style='color:#FBFBFF;'>consumers</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>not</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>problem</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>perform</span> <span style='color:#FBFBFF;'>synchronous</span> <span style='color:#FBFBFF;'>or</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>blocking</span> <span style='color:#FBFBFF;'>actions</span> <span style='color:#FBFBFF;'>inside</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>you</span> <span style='color:#FBFBFF;'>can</span> <span style='color:#FBFBFF;'>then</span> <span style='color:#FBFBFF;'>start</span> <span style='color:#FBFBFF;'>multiple</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>order</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>max</span> <span style='color:#FBFBFF;'>both</span> <span style='color:#FBFBFF;'>CPU</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>IO</span> <span style='color:#FBFBFF;'>usage</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>necessary</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>On</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>other</span> <span style='color:#FBFBFF;'>hand</span><span style='color:#FBFBFF;'>,</span> <span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>you</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>perform</span> <span style='color:#FBFBFF;'>some</span> <span style='color:#FBFBFF;'>work</span> <span style='color:#FBFBFF;'>asynchronously</span><span style='color:#FBFBFF;'>,</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>GenStage</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>comes</span> <span style='color:#FBFBFF;'>with</span> <span style='color:#FBFBFF;'>an</span> <span style='color:#FBFBFF;'>option</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>manually</span> <span style='color:#FBFBFF;'>controls</span> <span style='color:#FBFBFF;'>how</span> <span style='color:#FBFBFF;'>demand</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>upstream</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>avoiding</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>default</span> <span style='color:#FBFBFF;'>behaviour</span> <span style='color:#FBFBFF;'>where</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>is</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>after</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Such</span> <span style='color:#FBFBFF;'>can</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>done</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>implementing</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>subscribe</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>4</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>callback</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>returning</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:manual</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>instead</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>default</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:automatic</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Once</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>mode</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>set</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:manual</i></span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>developers</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>`</span><span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>ask</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>send</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>upstream</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>necessary</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Note</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:max</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:min</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>manually</span> <span style='color:#FBFBFF;'>respected</span> <span style='color:#FBFBFF;'>when</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>manually</span> <span style='color:#FBFBFF;'>asking</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>through</span> <span style='color:#FBFBFF;'>`</span><span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>ask</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>For</span> <span style='color:#FBFBFF;'>example</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>ConsumerSupervisor</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>module</span> <span style='color:#FBFBFF;'>processes</span> <span style='color:#FBFBFF;'>events</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>asynchronously</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>starting</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>process</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>each</span> <span style='color:#FBFBFF;'>event</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>this</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>achieved</span> <span style='color:#FBFBFF;'>by</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>manually</span> <span style='color:#FBFBFF;'>sending</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>producers</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>ConsumerSupervisor</span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>can</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>used</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>distribute</span> <span style='color:#FBFBFF;'>work</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>limited</span> <span style='color:#FBFBFF;'>amount</span> <span style='color:#FBFBFF;'>of</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>processes</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>behaving</span> <span style='color:#FBFBFF;'>similar</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>pool</span> <span style='color:#FBFBFF;'>where</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>new</span> <span style='color:#FBFBFF;'>process</span> <span style='color:#FBFBFF;'>is</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>started</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>each</span> <span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>See</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>ConsumerSupervisor</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>docs</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>more</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>information</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Setting</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:manual</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>subscribe</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>4</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>not</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>only</span> <span style='color:#FBFBFF;'>useful</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>asynchronous</span> <span style='color:#FBFBFF;'>work</span> <span style='color:#FBFBFF;'>but</span> <span style='color:#FBFBFF;'>also</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>setting</span> <span style='color:#FBFBFF;'>up</span> <span style='color:#FBFBFF;'>other</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>mechanisms</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>back</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>pressure</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>As</span> <span style='color:#FBFBFF;'>an</span> <span style='color:#FBFBFF;'>example</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>let</span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>s</span> <span style='color:#FBFBFF;'>implement</span> <span style='color:#FBFBFF;'>a</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>allowed</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>process</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>limited</span> <span style='color:#FBFBFF;'>number</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>events</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>per</span> <span style='color:#FBFBFF;'>time</span> <span style='color:#FBFBFF;'>interval</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Those</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>often</span> <span style='color:#FBFBFF;'>called</span> <span style='color:#FBFBFF;'>rate</span> <span style='color:#FBFBFF;'>limiters:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>defmodule</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>RateLimiter</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>GenStage</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>init</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>_</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#565857;'><i># Our state will keep all producers and their pending demand</i></span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:consumer</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>%</span><span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>handle</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>subscribe</span><span style='color:#9A8BBB;'>(</span><span style='color:#EAC435;'>:producer</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>opts</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>from</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>producers</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#565857;'><i># We will only allow max</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>every</span> <span style='color:#FBFBFF;'>5000</span> <span style='color:#FBFBFF;'>milliseconds</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>pending</span> <span style='color:#1098F7;'>=</span> <span style='color:#FBFBFF;'>opts</span><span style='color:#FBFBFF;'>[</span><span style='color:#EAC435;'><i>:max</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>]</span> <span style='color:#FBFBFF;'>|</span><span style='color:#FBFBFF;'>|</span> <span style='color:#FBFBFF;'>1000</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>interval</span> <span style='color:#1098F7;'>=</span> <span style='color:#FBFBFF;'>opts</span><span style='color:#FBFBFF;'>[</span><span style='color:#EAC435;'><i>:interval</i></span><span style='color:#FBFBFF;'>]</span> <span style='color:#FBFBFF;'>|</span><span style='color:#FBFBFF;'>|</span> <span style='color:#FBFBFF;'>5000</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>           <span style='color:#565857;'><i># Register the producer in the state</i></span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>producers</span> <span style='color:#1098F7;'>=</span> <span style='color:#D7B884;'>Map.</span><span style='color:#FBFBFF;'>put</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>producers</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>pending</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>interval</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#565857;'><i># Ask for the pending events and schedule the next time around</i></span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>producers</span> <span style='color:#1098F7;'>=</span> <span style='color:#FBFBFF;'>ask</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>and</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>schedule</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>producers</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>           <span style='color:#565857;'><i># Returns manual as we want control over the demand</i></span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:manual</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>producers</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>handle</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>cancel</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>_</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>from</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>producers</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#565857;'><i># Remove the producers from the map on unsubscribe</i></span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#D7B884;'>Map.</span><span style='color:#FBFBFF;'>delete</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>producers</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>handle</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>events</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>events</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>from</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>producers</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#565857;'><i># Bump the amount of pending events for the given producer</i></span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>producers</span> <span style='color:#1098F7;'>=</span> <span style='color:#D7B884;'>Map.</span><span style='color:#FBFBFF;'>update</span><span style='color:#1098F7;'>!</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>producers</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>,</span> <span style='color:#1098F7;'>fn</span> <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>pending</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>interval</span><span style='color:#FBFBFF;'>}</span> <span style='color:#1098F7;'>-</span><span style='color:#1098F7;'>></span>
 <span style='color:#C19875'> ·</span>             <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>pending</span> <span style='color:#1098F7;'>+</span> <span style='color:#FBFBFF;'>length</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>interval</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#1098F7;'>end</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>           <span style='color:#565857;'><i># Consume the events by printing them.</i></span>
 <span style='color:#C19875'> ·</span>           <span style='color:#D7B884;'>IO.</span><span style='color:#FBFBFF;'>inspect</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>           <span style='color:#565857;'><i># A producer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>would</span> <span style='color:#FBFBFF;'>return</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>processed</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>here</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>producers</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>handle</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>info</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>{</span><span style='color:#EAC435;'>:ask</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>from</span><span style='color:#03DDB2;'>}</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>producers</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#565857;'><i># This callback is invoked by the Process.send</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>after</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span> <span style='color:#FBFBFF;'>message</span> <span style='color:#FBFBFF;'>below</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>ask</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>and</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>schedule</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>producers</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>defp</span> <span style='color:#FBFBFF;'>ask</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>and</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>schedule</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>producers</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>)</span> <span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#FBFBFF;'>case</span> <span style='color:#FBFBFF;'>producers</span> <span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>             <span style='color:#FBFBFF;'>%</span><span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>^</span><span style='color:#FBFBFF;'>from</span> <span style='color:#1098F7;'>=</span><span style='color:#1098F7;'>></span> <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>pending</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>interval</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>}</span> <span style='color:#1098F7;'>-</span><span style='color:#1098F7;'>></span>
 <span style='color:#C19875'> ·</span>               <span style='color:#565857;'><i># Ask for any pending events</i></span>
 <span style='color:#C19875'> ·</span>               <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>ask</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>pending</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>               <span style='color:#565857;'><i># And let</i></span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>s</span> <span style='color:#FBFBFF;'>check</span> <span style='color:#FBFBFF;'>again</span> <span style='color:#FBFBFF;'>after</span> <span style='color:#FBFBFF;'>interval</span>
 <span style='color:#C19875'> ·</span>               <span style='color:#D7B884;'>Process.</span><span style='color:#FBFBFF;'>send</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>after</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>self</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:ask</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>interval</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>               <span style='color:#565857;'><i># Finally, reset pending events to 0</i></span>
 <span style='color:#C19875'> ·</span>               <span style='color:#D7B884;'>Map.</span><span style='color:#FBFBFF;'>put</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>producers</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>0</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>interval</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>             <span style='color:#FBFBFF;'>%</span><span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>}</span> <span style='color:#1098F7;'>-</span><span style='color:#1098F7;'>></span>
 <span style='color:#C19875'> ·</span>               <span style='color:#FBFBFF;'>producers</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Let</span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>s</span> <span style='color:#FBFBFF;'>subscribe</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>RateLimiter</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>above</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>have</span> <span style='color:#FBFBFF;'>implemented</span> <span style='color:#FBFBFF;'>at</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>beginning</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>module</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>documentation:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>a</span><span style='color:#FBFBFF;'>}</span> <span style='color:#1098F7;'>=</span> <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>A</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>0</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>b</span><span style='color:#FBFBFF;'>}</span> <span style='color:#1098F7;'>=</span> <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>RateLimiter</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#565857;'><i># Ask for 10 items every 2 seconds</i></span>
 <span style='color:#C19875'> ·</span>       <span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>sync</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>subscribe</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>b</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>to:</span> <span style='color:#FBFBFF;'>a</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>max</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand:</span> <span style='color:#FBFBFF;'>10</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>interval:</span> <span style='color:#FBFBFF;'>2000</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Although</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>rate</span> <span style='color:#FBFBFF;'>limiter</span> <span style='color:#FBFBFF;'>above</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>could</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>made</span> <span style='color:#FBFBFF;'>a</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>producer</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>changing</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:init</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>1</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>return</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>then</span> <span style='color:#FBFBFF;'>forwarding</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># Notifications</i></span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>GenStage</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>also</span> <span style='color:#FBFBFF;'>supports</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>ability</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>send</span> <span style='color:#FBFBFF;'>notifications</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>all</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>consumers</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Those</span> <span style='color:#FBFBFF;'>notifications</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>regular</span> <span style='color:#FBFBFF;'>messages</span> <span style='color:#FBFBFF;'>outside</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>driven</span> <span style='color:#FBFBFF;'>protocol</span> <span style='color:#FBFBFF;'>but</span> <span style='color:#FBFBFF;'>respecting</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>event</span> <span style='color:#FBFBFF;'>ordering</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>See</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>sync</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>notify</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>async</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>notify</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Notifications</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>useful</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>out</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>of</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>band</span> <span style='color:#FBFBFF;'>information</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>example</span><span style='color:#FBFBFF;'>,</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>notify</span> <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>has</span> <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>all</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>had</span> <span style='color:#FBFBFF;'>to</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>process</span> <span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>new</span> <span style='color:#FBFBFF;'>batch</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>starting</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Note</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>notification</span> <span style='color:#FBFBFF;'>system</span> <span style='color:#FBFBFF;'>should</span> <span style='color:#FBFBFF;'>not</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>used</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>broadcasting</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>;</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>such</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>consider</span> <span style='color:#FBFBFF;'>using</span> <span style='color:#FBFBFF;'>`</span><span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>BroadcastDispatcher</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># Callbacks</i></span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>GenStage</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>implemented</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>top</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>GenServer</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>with</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>few</span> <span style='color:#FBFBFF;'>additions</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Besides</span> <span style='color:#FBFBFF;'>exposing</span> <span style='color:#FBFBFF;'>all</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>GenServer</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>callbacks</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>also</span> <span style='color:#FBFBFF;'>provides</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>implemented</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>producers</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>be</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>implemented</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>consumers</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>shown</span> <span style='color:#FBFBFF;'>above</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>well</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>subscription</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>related</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>callbacks</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Furthermore</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>all</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>callback</span> <span style='color:#FBFBFF;'>responses</span> <span style='color:#FBFBFF;'>have</span> <span style='color:#FBFBFF;'>been</span> <span style='color:#FBFBFF;'>modified</span> <span style='color:#FBFBFF;'>to</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>potentially</span> <span style='color:#FBFBFF;'>emit</span> <span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>See</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>callbacks</span> <span style='color:#FBFBFF;'>documentation</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>more</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>information</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>By</span> <span style='color:#FBFBFF;'>adding</span> <span style='color:#FBFBFF;'>`</span><span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>GenStage</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>your</span> <span style='color:#FBFBFF;'>module</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>Elixir</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>automatically</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>define</span> <span style='color:#FBFBFF;'>all</span> <span style='color:#FBFBFF;'>callbacks</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>you</span> <span style='color:#FBFBFF;'>except</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>following</span> <span style='color:#FBFBFF;'>ones:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>init</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>1</span><span style='color:#FBFBFF;'>`</span> <span style='color:#1098F7;'>-</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>implemented</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>choose</span> <span style='color:#FBFBFF;'>between</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:consumer</i></span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>stages</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span> <span style='color:#1098F7;'>-</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>implemented</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>stages</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span> <span style='color:#1098F7;'>-</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>implemented</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:consumer</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>stages</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Although</span> <span style='color:#FBFBFF;'>this</span> <span style='color:#FBFBFF;'>module</span> <span style='color:#FBFBFF;'>exposes</span> <span style='color:#FBFBFF;'>functions</span> <span style='color:#FBFBFF;'>similar</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>ones</span> <span style='color:#FBFBFF;'>found</span> <span style='color:#FBFBFF;'>in</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>GenServer</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>API</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>like</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>call</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>cast</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>developers</span> <span style='color:#FBFBFF;'>can</span> <span style='color:#FBFBFF;'>also</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>rely</span> <span style='color:#FBFBFF;'>directly</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>GenServer</span> <span style='color:#FBFBFF;'>functions</span> <span style='color:#FBFBFF;'>such</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>`</span><span style='color:#D7B884;'>GenServer.</span><span style='color:#FBFBFF;'>multi</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>call</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>4</span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#D7B884;'>GenServer.</span><span style='color:#FBFBFF;'>abcast</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span> <span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>they</span> <span style='color:#FBFBFF;'>wish</span> <span style='color:#FBFBFF;'>to</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># Name registration</i></span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>GenStage</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>bound</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>same</span> <span style='color:#FBFBFF;'>name</span> <span style='color:#FBFBFF;'>registration</span> <span style='color:#FBFBFF;'>rules</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>GenServer</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Read</span> <span style='color:#FBFBFF;'>more</span> <span style='color:#FBFBFF;'>about</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>GenServer</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>docs</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># Message protocol overview</i></span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>This</span> <span style='color:#FBFBFF;'>section</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>describe</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>message</span> <span style='color:#FBFBFF;'>protocol</span> <span style='color:#FBFBFF;'>implemented</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>stages</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>By</span> <span style='color:#FBFBFF;'>documenting</span> <span style='color:#FBFBFF;'>these</span> <span style='color:#FBFBFF;'>messages</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>allow</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>developers</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>provide</span> <span style='color:#FBFBFF;'>their</span> <span style='color:#FBFBFF;'>own</span> <span style='color:#FBFBFF;'>stage</span> <span style='color:#FBFBFF;'>implementations</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># Back-pressure</i></span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>When</span> <span style='color:#FBFBFF;'>data</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>between</span> <span style='color:#FBFBFF;'>stages</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>done</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>message</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>protocol</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>provides</span> <span style='color:#FBFBFF;'>back</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>pressure</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>first</span> <span style='color:#FBFBFF;'>step</span> <span style='color:#FBFBFF;'>is</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>subscribe</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Each</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>subscription</span> <span style='color:#FBFBFF;'>has</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>unique</span> <span style='color:#FBFBFF;'>reference</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Once</span> <span style='color:#FBFBFF;'>subscribed</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>ask</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>messages</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>given</span> <span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>more</span> <span style='color:#FBFBFF;'>items</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>whenever</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>wants</span> <span style='color:#FBFBFF;'>to</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>A</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>never</span> <span style='color:#FBFBFF;'>receive</span> <span style='color:#FBFBFF;'>more</span> <span style='color:#FBFBFF;'>data</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>than</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>has</span> <span style='color:#FBFBFF;'>asked</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>from</span> <span style='color:#FBFBFF;'>any</span> <span style='color:#FBFBFF;'>given</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>stage</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>A</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>have</span> <span style='color:#FBFBFF;'>multiple</span> <span style='color:#FBFBFF;'>producers</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>where</span> <span style='color:#FBFBFF;'>each</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>managed</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>individually</span> <span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>per</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>subscription</span> <span style='color:#FBFBFF;'>basis</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>A</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>have</span> <span style='color:#FBFBFF;'>multiple</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>consumers</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>where</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>managed</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>delivered</span> <span style='color:#FBFBFF;'>according</span> <span style='color:#FBFBFF;'>to</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>`</span><span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>Dispatcher</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>implementation</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># Producer messages</i></span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>responsible</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>sending</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>consumers</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>based</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>These</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>messages</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>can</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>send</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>producers:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#1098F7;'>:</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>$</span><span style='color:#FBFBFF;'>gen</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>producer</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>from</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>pid</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>tag</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:subscribe</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>current</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>options</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#1098F7;'>-</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>start</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>new</span> <span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>Before</span> <span style='color:#FBFBFF;'>sending</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>MUST</span> <span style='color:#FBFBFF;'>monitor</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>clean</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>up</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>purposes</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>case</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>crashes</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>tag</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>unique</span> <span style='color:#FBFBFF;'>to</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>identify</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>It</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>typically</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>subscriber</span> <span style='color:#FBFBFF;'>monitoring</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>reference</span> <span style='color:#FBFBFF;'>although</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>any</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>Once</span> <span style='color:#FBFBFF;'>sent</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>MAY</span> <span style='color:#FBFBFF;'>immediately</span> <span style='color:#FBFBFF;'>send</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>current</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>field</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>not</span> <span style='color:#FBFBFF;'>`</span><span style='color:#4ECDC4;'><i>nil</i></span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>two</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>item</span> <span style='color:#FBFBFF;'>tuple</span> <span style='color:#FBFBFF;'>containing</span> <span style='color:#FBFBFF;'>a</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>subscription</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>cancelled</span> <span style='color:#FBFBFF;'>with</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>given</span> <span style='color:#FBFBFF;'>reason</span> <span style='color:#FBFBFF;'>before</span> <span style='color:#FBFBFF;'>the</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>current</span> <span style='color:#FBFBFF;'>one</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>accepted</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>Once</span> <span style='color:#FBFBFF;'>received</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>MUST</span> <span style='color:#FBFBFF;'>monitor</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>However</span><span style='color:#FBFBFF;'>,</span> <span style='color:#1098F7;'>if</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>subscription</span> <span style='color:#FBFBFF;'>reference</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>known</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>MUST</span> <span style='color:#FBFBFF;'>send</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:cancel</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>message</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>instead</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>monitoring</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>accepting</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#1098F7;'>:</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>$</span><span style='color:#FBFBFF;'>gen</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>producer</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>from</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>pid</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>tag</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:cancel</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#1098F7;'>-</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>cancel</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>given</span> <span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>Once</span> <span style='color:#FBFBFF;'>received</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>MUST</span> <span style='color:#FBFBFF;'>send</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:cancel</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>reply</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>registered</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>which</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>not</span> <span style='color:#FBFBFF;'>necessarily</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>one</span> <span style='color:#FBFBFF;'>received</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>tuple</span> <span style='color:#FBFBFF;'>above</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Keep</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>mind</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>however</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>there</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>no</span> <span style='color:#FBFBFF;'>guarantee</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>such</span> <span style='color:#FBFBFF;'>messages</span> <span style='color:#FBFBFF;'>can</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>delivered</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>case</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>crashes</span> <span style='color:#FBFBFF;'>before</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>If</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>pair</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>unknown</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>MUST</span> <span style='color:#FBFBFF;'>send</span> <span style='color:#FBFBFF;'>an</span> <span style='color:#FBFBFF;'>appropriate</span> <span style='color:#FBFBFF;'>cancel</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>reply</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#1098F7;'>:</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>$</span><span style='color:#FBFBFF;'>gen</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>producer</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>from</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>pid</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>tag</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:ask</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#1098F7;'>-</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>ask</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>given</span> <span style='color:#FBFBFF;'>subscription</span> <span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>identified</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>tag</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>Once</span> <span style='color:#FBFBFF;'>received</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>MUST</span> <span style='color:#FBFBFF;'>send</span> <span style='color:#FBFBFF;'>data</span> <span style='color:#FBFBFF;'>up</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>If</span> <span style='color:#FBFBFF;'>the</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>pair</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>unknown</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>MUST</span> <span style='color:#FBFBFF;'>send</span> <span style='color:#FBFBFF;'>an</span> <span style='color:#FBFBFF;'>appropriate</span> <span style='color:#FBFBFF;'>cancel</span> <span style='color:#FBFBFF;'>reply</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># Consumer messages</i></span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>responsible</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>starting</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>subscription</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>sending</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>producers</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>These</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>messages</span> <span style='color:#FBFBFF;'>that</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>producers</span> <span style='color:#FBFBFF;'>can</span> <span style='color:#FBFBFF;'>send</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>consumers:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#1098F7;'>:</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>$</span><span style='color:#FBFBFF;'>gen</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>from</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>producer</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>pid</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>tag</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:notification</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>message</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#1098F7;'>-</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>notifications</span> <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>producers</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#1098F7;'>:</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>$</span><span style='color:#FBFBFF;'>gen</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>from</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>producer</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>pid</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>tag</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:cancel</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#1098F7;'>-</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>producers</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>cancel</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>given</span> <span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>It</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>used</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>confirmation</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>client</span> <span style='color:#FBFBFF;'>cancellations</span> <span style='color:#FBFBFF;'>OR</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>whenever</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>wants</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>cancel</span> <span style='color:#FBFBFF;'>some</span> <span style='color:#FBFBFF;'>upstream</span> <span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#1098F7;'>:</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>$</span><span style='color:#FBFBFF;'>gen</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>from</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>producer</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>pid</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>tag</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#1098F7;'>-</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>producers</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>consumers</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>tag</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>identifies</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>third</span> <span style='color:#FBFBFF;'>argument</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>non</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>empty</span> <span style='color:#FBFBFF;'>list</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>If</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>subscription</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>unknown</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>ignored</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>cancel</span> <span style='color:#FBFBFF;'>message</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>defstruct</span> <span style='color:#FBFBFF;'>[</span><span style='color:#EAC435;'><i>:mod</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:state</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:type</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:dispatcher</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>mod</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:dispatcher</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:buffer</i></span><span style='color:#FBFBFF;'>,</span>
 <span style='color:#C19875'> ·</span>              <span style='color:#EAC435;'><i>:buffer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>config</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>events:</span> <span style='color:#EAC435;'><i>:forward</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>monitors:</span> <span style='color:#FBFBFF;'>%</span><span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>producers:</span> <span style='color:#FBFBFF;'>%</span><span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>consumers:</span> <span style='color:#FBFBFF;'>%</span><span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>]</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@typedoc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>supported</span> <span style='color:#FBFBFF;'>stage</span> <span style='color:#FBFBFF;'>types</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@type</span> <span style='color:#FBFBFF;'>type</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#EAC435;'><i>:producer</i></span> <span style='color:#FBFBFF;'>|</span> <span style='color:#EAC435;'><i>:consumer</i></span> <span style='color:#FBFBFF;'>|</span> <span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@typedoc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>supported</span> <span style='color:#FBFBFF;'>init</span> <span style='color:#FBFBFF;'>options</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@type</span> <span style='color:#FBFBFF;'>options</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>keyword</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@typedoc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>stage</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@type</span> <span style='color:#FBFBFF;'>stage</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>pid</span> <span style='color:#FBFBFF;'>|</span> <span style='color:#FBFBFF;'>atom</span> <span style='color:#FBFBFF;'>|</span> <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:global</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span> <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:via</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>module</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span> <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>atom</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>node</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@typedoc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>term</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>identifies</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@opaque</span> <span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>tag</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>reference</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@typedoc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>term</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>identifies</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>subscription</span> <span style='color:#FBFBFF;'>associated</span> <span style='color:#FBFBFF;'>with</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>corresponding</span> <span style='color:#FBFBFF;'>producer</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@type</span> <span style='color:#FBFBFF;'>from</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>pid</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>subscription</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>tag</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@doc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Invoked</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>server</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>started</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>)</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>block</span> <span style='color:#FBFBFF;'>until</span> <span style='color:#FBFBFF;'>this</span> <span style='color:#FBFBFF;'>callback</span> <span style='color:#FBFBFF;'>returns</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>args</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>argument</span> <span style='color:#FBFBFF;'>term</span> <span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>second</span> <span style='color:#FBFBFF;'>argument</span><span style='color:#FBFBFF;'>)</span> <span style='color:#FBFBFF;'>passed</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>In</span> <span style='color:#FBFBFF;'>case</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>successful</span> <span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>this</span> <span style='color:#FBFBFF;'>callback</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>return</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>tuple</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>where</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>first</span> <span style='color:#FBFBFF;'>element</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>stage</span> <span style='color:#FBFBFF;'>type</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>which</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>one</span> <span style='color:#FBFBFF;'>of:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:consumer</i></span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>(</span><span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>stage</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>acting</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>both</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>For</span> <span style='color:#FBFBFF;'>example:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>init</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>args</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>some</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>returned</span> <span style='color:#FBFBFF;'>tuple</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>also</span> <span style='color:#FBFBFF;'>contain</span> <span style='color:#FBFBFF;'>3</span> <span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>4</span> <span style='color:#FBFBFF;'>elements</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>third</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>element</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:hibernate</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>atom</span> <span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>set</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>options</span> <span style='color:#FBFBFF;'>defined</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>below</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Returning</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:ignore</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>cause</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>return</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:ignore</i></span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>process</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>exit</span> <span style='color:#FBFBFF;'>normally</span> <span style='color:#FBFBFF;'>without</span> <span style='color:#FBFBFF;'>entering</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>loop</span> <span style='color:#FBFBFF;'>or</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>calling</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>terminate</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Returning</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:stop</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>cause</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>start</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>link</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>return</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:error</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>process</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>exit</span> <span style='color:#FBFBFF;'>with</span> <span style='color:#FBFBFF;'>reason</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>without</span> <span style='color:#FBFBFF;'>entering</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>loop</span> <span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>calling</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>terminate</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># Options</i></span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>This</span> <span style='color:#FBFBFF;'>callback</span> <span style='color:#FBFBFF;'>may</span> <span style='color:#FBFBFF;'>return</span> <span style='color:#FBFBFF;'>options</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Some</span> <span style='color:#FBFBFF;'>options</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>specific</span> <span style='color:#FBFBFF;'>to</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>chosen</span> <span style='color:#FBFBFF;'>stage</span> <span style='color:#FBFBFF;'>type</span> <span style='color:#FBFBFF;'>while</span> <span style='color:#FBFBFF;'>others</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>shared</span> <span style='color:#FBFBFF;'>across</span> <span style='color:#FBFBFF;'>all</span> <span style='color:#FBFBFF;'>types</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># </i></span><span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>options</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:demand</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#1098F7;'>-</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:forward</i></span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>always</span> <span style='color:#FBFBFF;'>forwarded</span> <span style='color:#FBFBFF;'>to</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>callback</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>When</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:accumulate</i></span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>is</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>accumulated</span> <span style='color:#FBFBFF;'>until</span> <span style='color:#FBFBFF;'>its</span> <span style='color:#FBFBFF;'>mode</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>set</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:forward</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>via</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>This</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>useful</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>synchronization</span> <span style='color:#FBFBFF;'>mechanism</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>where</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>accumulated</span> <span style='color:#FBFBFF;'>until</span> <span style='color:#FBFBFF;'>all</span> <span style='color:#FBFBFF;'>consumers</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>subscribed</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Defaults</span> <span style='color:#FBFBFF;'>to</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:forward</i></span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># </i></span><span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>options</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:buffer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>size</span><span style='color:#FBFBFF;'>`</span> <span style='color:#1098F7;'>-</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>size</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>buffer</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>store</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>without</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Can</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:infinity</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>signal</span> <span style='color:#FBFBFF;'>no</span> <span style='color:#FBFBFF;'>limit</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>buffer</span> <span style='color:#FBFBFF;'>size</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Check</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>Buffer</span> <span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>"</span> <span style='color:#FBFBFF;'>section</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>module</span> <span style='color:#FBFBFF;'>documentation</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Defaults</span> <span style='color:#FBFBFF;'>to</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>10</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>0</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:infinity</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:buffer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>keep</span><span style='color:#FBFBFF;'>`</span> <span style='color:#1098F7;'>-</span> <span style='color:#FBFBFF;'>returns</span> <span style='color:#FBFBFF;'>whether</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:first</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:last</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>entries</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>should</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>kept</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>buffer</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>case</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>buffer</span> <span style='color:#FBFBFF;'>size</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>exceeded</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>Defaults</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:last</i></span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:dispatcher</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#1098F7;'>-</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>dispatcher</span> <span style='color:#FBFBFF;'>responsible</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>handling</span> <span style='color:#FBFBFF;'>demands</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>Defaults</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>`</span><span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>DemandDispatch</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>May</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>either</span> <span style='color:#FBFBFF;'>an</span> <span style='color:#FBFBFF;'>atom</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>representing</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>dispatcher</span> <span style='color:#FBFBFF;'>module</span> <span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>two</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>element</span> <span style='color:#FBFBFF;'>tuple</span> <span style='color:#FBFBFF;'>with</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>dispatcher</span> <span style='color:#FBFBFF;'>module</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>dispatcher</span> <span style='color:#FBFBFF;'>options</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># </i></span><span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:consumer</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>options</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:subscribe</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>to</span><span style='color:#FBFBFF;'>`</span> <span style='color:#1098F7;'>-</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>list</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>producers</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>subscribe</span> <span style='color:#FBFBFF;'>to</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Each</span> <span style='color:#FBFBFF;'>element</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>represents</span> <span style='color:#FBFBFF;'>either</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>module</span> <span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>tuple</span> <span style='color:#FBFBFF;'>with</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>module</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>subscription</span> <span style='color:#FBFBFF;'>options</span> <span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>defined</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>sync</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>subscribe</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@callback</span> <span style='color:#FBFBFF;'>init</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>args</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>)</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>type</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>type</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>options</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#EAC435;'><i>:ignore</i></span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:stop</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>any</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>state:</span> <span style='color:#FBFBFF;'>any</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@doc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Invoked</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>stages</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>This</span> <span style='color:#FBFBFF;'>callback</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>invoked</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>stages</span> <span style='color:#FBFBFF;'>with</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>from</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>consumers</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>dispatcher</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>producer</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>implements</span> <span style='color:#FBFBFF;'>this</span> <span style='color:#FBFBFF;'>callback</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>either</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>store</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>return</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>amount</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>requested</span> <span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Must</span> <span style='color:#FBFBFF;'>always</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>explicitly</span> <span style='color:#FBFBFF;'>implemented</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>stages</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># Examples</i></span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>handle</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>demand</span><span style='color:#9A8BBB;'>(</span><span style='color:#03DDB2;'>demand</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>state</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#565857;'><i># We check if we</i></span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>re</span> <span style='color:#FBFBFF;'>able</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>satisfy</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>fetch</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#565857;'><i># events if we aren</i></span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>t</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>events</span> <span style='color:#1098F7;'>=</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>length</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>)</span> <span style='color:#1098F7;'>></span><span style='color:#1098F7;'>=</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>             <span style='color:#FBFBFF;'>events</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#1098F7;'>else</span>
 <span style='color:#C19875'> ·</span>             <span style='color:#FBFBFF;'>fetch</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span>           <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#565857;'><i># We dispatch only the requested number of events.</i></span>
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>to</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>dispatch</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>remaining</span><span style='color:#FBFBFF;'>}</span> <span style='color:#1098F7;'>=</span> <span style='color:#D7B884;'>Enum.</span><span style='color:#FBFBFF;'>split</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>)</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>to</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>dispatch</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>%</span><span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>state</span> <span style='color:#FBFBFF;'>|</span> <span style='color:#FBFBFF;'>events:</span> <span style='color:#FBFBFF;'>remaining</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@callback</span> <span style='color:#FBFBFF;'>handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>demand</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>demand</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>pos</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>integer</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>)</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:hibernate</i></span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:stop</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>event:</span> <span style='color:#FBFBFF;'>term</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@doc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Invoked</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>subscribes</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>producer</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>This</span> <span style='color:#FBFBFF;'>callback</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>invoked</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>both</span> <span style='color:#FBFBFF;'>producers</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>consumers</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>producer</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>or</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>this</span> <span style='color:#FBFBFF;'>callback</span> <span style='color:#FBFBFF;'>is</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>invoked</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>subscribed</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>producer</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:consumer</i></span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>this</span> <span style='color:#FBFBFF;'>callback</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>invoked</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>producers</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>subscribed</span> <span style='color:#FBFBFF;'>to</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>For</span> <span style='color:#FBFBFF;'>consumers</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>successful</span> <span style='color:#FBFBFF;'>subscriptions</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>return</span> <span style='color:#FBFBFF;'>one</span> <span style='color:#FBFBFF;'>of:</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:automatic</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#1098F7;'>-</span> <span style='color:#FBFBFF;'>means</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>stage</span> <span style='color:#FBFBFF;'>implementation</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>take</span> <span style='color:#FBFBFF;'>care</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>automatically</span> <span style='color:#FBFBFF;'>sending</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>producers</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>This</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>default</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>*</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:manual</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#1098F7;'>-</span> <span style='color:#FBFBFF;'>means</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>producers</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>explicitly</span> <span style='color:#FBFBFF;'>via</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>ask</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:manual</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>subscriptions</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>cancelled</span> <span style='color:#FBFBFF;'>when</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>cancel</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>called</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:manual</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>can</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>used</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>special</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>behaviour</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>desired</span> <span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>example</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>ConsumerSupervisor</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>uses</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:manual</i></span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>its</span> <span style='color:#FBFBFF;'>implementation</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>For</span> <span style='color:#FBFBFF;'>producers</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>successful</span> <span style='color:#FBFBFF;'>subscriptions</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>always</span> <span style='color:#FBFBFF;'>return</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:automatic</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:manual</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>mode</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>not</span> <span style='color:#FBFBFF;'>supported</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>If</span> <span style='color:#FBFBFF;'>this</span> <span style='color:#FBFBFF;'>callback</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>not</span> <span style='color:#FBFBFF;'>implemented</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>default</span> <span style='color:#FBFBFF;'>implementation</span> <span style='color:#FBFBFF;'>by</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>GenStage</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>return</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:automatic</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#565857;'><i>#</i></span><span style='color:#565857;'><i># Examples</i></span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Let</span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>s</span> <span style='color:#FBFBFF;'>see</span> <span style='color:#FBFBFF;'>an</span> <span style='color:#FBFBFF;'>example</span> <span style='color:#FBFBFF;'>where</span> <span style='color:#FBFBFF;'>we</span> <span style='color:#FBFBFF;'>define</span> <span style='color:#FBFBFF;'>this</span> <span style='color:#FBFBFF;'>callback</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#1098F7;'>use</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:manual</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>mode</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>In</span> <span style='color:#FBFBFF;'>this</span> <span style='color:#FBFBFF;'>case</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>we</span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>ll</span> <span style='color:#FBFBFF;'>store</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>subscription</span> <span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>)</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>the</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>state</span> <span style='color:#FBFBFF;'>in</span> <span style='color:#FBFBFF;'>order</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>able</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>it</span> <span style='color:#FBFBFF;'>later</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>asking</span> <span style='color:#FBFBFF;'>demand</span> <span style='color:#FBFBFF;'>via</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>ask</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>def</span><span style='color:#9A8BBB;'> </span><span style='color:#9A8BBB;'>handle</span><span style='color:#9A8BBB;'>_</span><span style='color:#9A8BBB;'>subscribe</span><span style='color:#9A8BBB;'>(</span><span style='color:#EAC435;'>:producer</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>_</span><span style='color:#03DDB2;'>options</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>from</span><span style='color:#9A8BBB;'>,</span><span style='color:#03DDB2;'> </span><span style='color:#03DDB2;'>state</span><span style='color:#9A8BBB;'>)</span><span style='color:#9A8BBB;'> </span><span style='color:#1098F7;'>do</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span> <span style='color:#1098F7;'>=</span> <span style='color:#FBFBFF;'>%</span><span style='color:#FBFBFF;'>{</span><span style='color:#FBFBFF;'>state</span> <span style='color:#FBFBFF;'>|</span> <span style='color:#FBFBFF;'>subscription:</span> <span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>}</span>
 <span style='color:#C19875'> ·</span>         <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:manual</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span>
 <span style='color:#C19875'> ·</span>       <span style='color:#1098F7;'>end</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@callback</span> <span style='color:#FBFBFF;'>handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>subscribe</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>producer</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>or</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#EAC435;'><i>:producer</i></span> <span style='color:#FBFBFF;'>|</span> <span style='color:#EAC435;'><i>:consumer</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>options</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>)</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:automatic</i></span> <span style='color:#FBFBFF;'>|</span> <span style='color:#EAC435;'><i>:manual</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:stop</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason:</span> <span style='color:#FBFBFF;'>term</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@doc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Invoked</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>consumer</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>no</span> <span style='color:#FBFBFF;'>longer</span> <span style='color:#FBFBFF;'>subscribed</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>producer</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>It</span> <span style='color:#FBFBFF;'>receives</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>cancellation</span> <span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>tuple</span> <span style='color:#FBFBFF;'>representing</span> <span style='color:#FBFBFF;'>the</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>cancelled</span> <span style='color:#FBFBFF;'>subscription</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>.</span>  <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>cancel</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>a</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:cancel</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>tuple</span> <span style='color:#1098F7;'>if</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>reason</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>cancellation</span> <span style='color:#FBFBFF;'>was</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>`</span><span style='color:#D7B884;'>GenStage.</span><span style='color:#FBFBFF;'>cancel</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>call</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Any</span> <span style='color:#FBFBFF;'>other</span> <span style='color:#FBFBFF;'>value</span> <span style='color:#FBFBFF;'>means</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>cancellation</span> <span style='color:#FBFBFF;'>reason</span> <span style='color:#FBFBFF;'>was</span> <span style='color:#FBFBFF;'>due</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>an</span> <span style='color:#D7B884;'>EXIT.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>If</span> <span style='color:#FBFBFF;'>this</span> <span style='color:#FBFBFF;'>callback</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>not</span> <span style='color:#FBFBFF;'>implemented</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>default</span> <span style='color:#FBFBFF;'>implementation</span> <span style='color:#FBFBFF;'>by</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>GenStage</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>return</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Return</span> <span style='color:#FBFBFF;'>values</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>same</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>cast</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@callback</span> <span style='color:#FBFBFF;'>handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>cancel</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>cancellation</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>reason</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:cancel</i></span> <span style='color:#FBFBFF;'>|</span> <span style='color:#EAC435;'><i>:down</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>)</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:hibernate</i></span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:stop</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>event:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason:</span> <span style='color:#FBFBFF;'>term</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@doc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Invoked</span> <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:producer</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>consumer</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:consumer</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>stages</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>handle</span> <span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Must</span> <span style='color:#FBFBFF;'>always</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>explicitly</span> <span style='color:#FBFBFF;'>implemented</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>such</span> <span style='color:#FBFBFF;'>types</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Return</span> <span style='color:#FBFBFF;'>values</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>same</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>cast</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@callback</span> <span style='color:#FBFBFF;'>handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>events</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>)</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:hibernate</i></span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:stop</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>event:</span> <span style='color:#FBFBFF;'>term</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@doc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Invoked</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>handle</span> <span style='color:#FBFBFF;'>synchronous</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>call</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>messages</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>call</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>block</span> <span style='color:#FBFBFF;'>until</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>reply</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>received</span> <span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>unless</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>call</span> <span style='color:#FBFBFF;'>times</span> <span style='color:#FBFBFF;'>out</span> <span style='color:#FBFBFF;'>or</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>nodes</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>disconnected</span><span style='color:#FBFBFF;'>)</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>request</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>request</span> <span style='color:#FBFBFF;'>message</span> <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>call</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>two</span><span style='color:#1098F7;'>-</span><span style='color:#FBFBFF;'>element</span> <span style='color:#FBFBFF;'>tuple</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>containing</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>caller</span><span style='color:#FBFBFF;'>'</span><span style='color:#FBFBFF;'>s</span> <span style='color:#FBFBFF;'>PID</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>term</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>uniquely</span> <span style='color:#FBFBFF;'>identifies</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>call</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>and</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>current</span> <span style='color:#FBFBFF;'>state</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>GenStage</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Returning</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:reply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reply</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>sends</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>response</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>reply</span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>caller</span> <span style='color:#FBFBFF;'>after</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>dispatched</span> <span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>or</span> <span style='color:#FBFBFF;'>buffered</span><span style='color:#FBFBFF;'>)</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>continues</span> <span style='color:#FBFBFF;'>the</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>loop</span> <span style='color:#FBFBFF;'>with</span> <span style='color:#FBFBFF;'>new</span> <span style='color:#FBFBFF;'>state</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>In</span> <span style='color:#FBFBFF;'>case</span> <span style='color:#FBFBFF;'>you</span> <span style='color:#FBFBFF;'>want</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>deliver</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>reply</span> <span style='color:#FBFBFF;'>before</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>processing</span> <span style='color:#FBFBFF;'>events</span><span style='color:#FBFBFF;'>,</span> <span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>reply</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>return</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Returning</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>does</span> <span style='color:#FBFBFF;'>not</span> <span style='color:#FBFBFF;'>send</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>response</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>caller</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>processes</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>given</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>before</span> <span style='color:#FBFBFF;'>continuing</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>loop</span> <span style='color:#FBFBFF;'>with</span> <span style='color:#FBFBFF;'>new</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>state</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>response</span> <span style='color:#FBFBFF;'>must</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>with</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>reply</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Hibernating</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>also</span> <span style='color:#FBFBFF;'>supported</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>an</span> <span style='color:#FBFBFF;'>atom</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>be</span> <span style='color:#FBFBFF;'>returned</span> <span style='color:#FBFBFF;'>from</span> <span style='color:#FBFBFF;'>either</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:reply</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>tuples</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Returning</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:stop</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reply</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>stops</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>loop</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>terminate</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>called</span> <span style='color:#FBFBFF;'>with</span> <span style='color:#FBFBFF;'>reason</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>state</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>Then</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>reply</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>sent</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>response</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>call</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>process</span> <span style='color:#FBFBFF;'>exits</span> <span style='color:#FBFBFF;'>with</span> <span style='color:#FBFBFF;'>reason</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Returning</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:stop</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>similar</span> <span style='color:#FBFBFF;'>to</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:stop</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reply</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>except</span> <span style='color:#FBFBFF;'>that</span> <span style='color:#FBFBFF;'>no</span> <span style='color:#FBFBFF;'>reply</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>caller</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>If</span> <span style='color:#FBFBFF;'>this</span> <span style='color:#FBFBFF;'>callback</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>not</span> <span style='color:#FBFBFF;'>implemented</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>default</span> <span style='color:#FBFBFF;'>implementation</span> <span style='color:#FBFBFF;'>by</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>GenStage</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>return</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:stop</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:bad</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>call</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>request</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@callback</span> <span style='color:#FBFBFF;'>handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>call</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>request</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>from</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#D7B884;'>GenServer.</span><span style='color:#FBFBFF;'>from</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>)</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:reply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reply</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:reply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reply</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:hibernate</i></span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:hibernate</i></span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:stop</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reply</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:stop</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>reply:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>event:</span> <span style='color:#FBFBFF;'>term</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@doc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Invoked</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>handle</span> <span style='color:#FBFBFF;'>asynchronous</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>cast</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>messages</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>request</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>request</span> <span style='color:#FBFBFF;'>message</span> <span style='color:#FBFBFF;'>sent</span> <span style='color:#FBFBFF;'>by</span> <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>cast</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>current</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>state</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>GenStage</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Returning</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>dispatches</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>events</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>continues</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>loop</span> <span style='color:#FBFBFF;'>with</span> <span style='color:#FBFBFF;'>new</span> <span style='color:#FBFBFF;'>state</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Returning</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:hibernate</i></span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>similar</span> <span style='color:#FBFBFF;'>to</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>except</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>process</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>hibernated</span> <span style='color:#FBFBFF;'>before</span> <span style='color:#FBFBFF;'>continuing</span> <span style='color:#FBFBFF;'>the</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>loop</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>See</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>return</span> <span style='color:#FBFBFF;'>values</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:GenServer</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>call</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>for</span> <span style='color:#FBFBFF;'>more</span> <span style='color:#FBFBFF;'>information</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>on</span> <span style='color:#FBFBFF;'>hibernation</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Returning</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:stop</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>stops</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>loop</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>terminate</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>called</span> <span style='color:#FBFBFF;'>with</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>reason</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>state</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>process</span> <span style='color:#FBFBFF;'>exits</span> <span style='color:#FBFBFF;'>with</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>reason</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>If</span> <span style='color:#FBFBFF;'>this</span> <span style='color:#FBFBFF;'>callback</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>not</span> <span style='color:#FBFBFF;'>implemented</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>default</span> <span style='color:#FBFBFF;'>implementation</span> <span style='color:#FBFBFF;'>by</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>GenStage</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>return</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:stop</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:bad</i></span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>cast</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>request</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@callback</span> <span style='color:#FBFBFF;'>handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>cast</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>request</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>)</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:hibernate</i></span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:stop</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>event:</span> <span style='color:#FBFBFF;'>term</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@doc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Invoked</span> <span style='color:#FBFBFF;'>to</span> <span style='color:#FBFBFF;'>handle</span> <span style='color:#FBFBFF;'>all</span> <span style='color:#FBFBFF;'>other</span> <span style='color:#FBFBFF;'>messages</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>message</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>message</span> <span style='color:#FBFBFF;'>and</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>current</span> <span style='color:#FBFBFF;'>state</span> <span style='color:#FBFBFF;'>of</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>GenStage</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span> <span style='color:#FBFBFF;'>When</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>a</span> <span style='color:#FBFBFF;'>timeout</span> <span style='color:#FBFBFF;'>occurs</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>message</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>`</span><span style='color:#EAC435;'><i>:timeout</i></span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>If</span> <span style='color:#FBFBFF;'>this</span> <span style='color:#FBFBFF;'>callback</span> <span style='color:#FBFBFF;'>is</span> <span style='color:#FBFBFF;'>not</span> <span style='color:#FBFBFF;'>implemented</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>default</span> <span style='color:#FBFBFF;'>implementation</span> <span style='color:#FBFBFF;'>by</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>`</span><span style='color:#1098F7;'>use</span> <span style='color:#FBFBFF;'>GenStage</span><span style='color:#FBFBFF;'>`</span> <span style='color:#FBFBFF;'>will</span> <span style='color:#FBFBFF;'>return</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>Return</span> <span style='color:#FBFBFF;'>values</span> <span style='color:#FBFBFF;'>are</span> <span style='color:#FBFBFF;'>the</span> <span style='color:#FBFBFF;'>same</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>cast</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@callback</span> <span style='color:#FBFBFF;'>handle</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>info</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>message</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>)</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:noreply</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>[</span><span style='color:#FBFBFF;'>event</span><span style='color:#FBFBFF;'>]</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>,</span> <span style='color:#EAC435;'><i>:hibernate</i></span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:stop</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>reason</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>event:</span> <span style='color:#FBFBFF;'>term</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@doc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>same</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:GenServer</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>terminate</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>2</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@callback</span> <span style='color:#FBFBFF;'>terminate</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>reason</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>)</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>term</span> <span style='color:#FBFBFF;'>when</span> <span style='color:#FBFBFF;'>reason:</span> <span style='color:#EAC435;'><i>:normal</i></span> <span style='color:#FBFBFF;'>|</span> <span style='color:#EAC435;'><i>:shutdown</i></span> <span style='color:#FBFBFF;'>|</span> <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:shutdown</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span> <span style='color:#FBFBFF;'>term</span>
 <span style='color:#C19875'> ·</span> 
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@doc</span> <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>The</span> <span style='color:#FBFBFF;'>same</span> <span style='color:#FBFBFF;'>as</span> <span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>c:GenServer</span><span style='color:#FBFBFF;'>.</span><span style='color:#FBFBFF;'>code</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>change</span><span style='color:#FBFBFF;'>/</span><span style='color:#FBFBFF;'>3</span><span style='color:#FBFBFF;'>`</span><span style='color:#FBFBFF;'>.</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span><span style='color:#FBFBFF;'>"</span>
 <span style='color:#C19875'> ·</span>   <span style='color:#C73E1D;'>@callback</span> <span style='color:#FBFBFF;'>code</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>change</span><span style='color:#FBFBFF;'>(</span><span style='color:#FBFBFF;'>old</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>vsn</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>state</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>extra</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>)</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span>
 <span style='color:#C19875'> ·</span>     <span style='color:#FBFBFF;'>{</span><span style='color:#EAC435;'><i>:ok</i></span><span style='color:#FBFBFF;'>,</span> <span style='color:#FBFBFF;'>new</span><span style='color:#FBFBFF;'>_</span><span style='color:#FBFBFF;'>state</span> <span style='color:#1098F7;'>:</span><span style='color:#1098F7;'>:</span> <span style='color:#FBFBFF;'>term</span><span style='color:#FBFBFF;'>}</span> <span style='color:#FBFBFF;'>|</span>
 <span style='color:#C19875'> ·</span> </code></pre><br></file>